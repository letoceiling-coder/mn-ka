# Импорт услуг из Excel

## Описание изменений

Изменена структура услуг:
- **Услуги (Service)** - основные услуги с полями: name, slug, description, image_id, icon_id, order, is_active
- **Разделы (Chapter)** - "Цель вашего обращения" (например, "Поиск и приобретение земельного участка")
- **Случаи (Case)** - "Подходящий случай" (например, "due diligence"), связанные с разделами

## Структура Excel файла

Файл должен содержать следующие колонки:
1. **Название услуги** - основная услуга (первая строка с названием)
2. **Раздел ( Цель вашего обращения )** - раздел, к которому относятся случаи
3. **Услуга ( Подходящий случай )** - конкретный случай, связанный с разделом
4. **Описание** - краткое описание
5. **Текст HTML** - HTML контент
6. **Текст страницы (подробное)** - подробное описание

## Логика импорта

1. Строка с заполненным "Название услуги" создает новую услугу
2. Строки с заполненным "Раздел" создают/находят раздел
3. Строки с заполненным "Услуга ( Подходящий случай )" создают случаи, связанные с текущим разделом

## Запуск импорта

```bash
php artisan db:seed --class=ServicesFromExcelSeeder
```

## Изменения в коде

### Frontend
- Обновлен компонент `OptionsStage.vue` для работы с разделами и случаями вместо option_trees и instances
- Обновлена страница `ServicePage.vue` для работы с новой структурой

### Backend
- Обновлен `ServiceResource` для возврата `available_chapters` с их случаями
- Обновлен `ServiceController` для поддержки новой структуры (chapter и case)
- Добавлена связь `cases()` в модель `Chapter`

## API изменения

### Получение услуги по slug
```
GET /api/public/services/{slug}
```

Возвращает:
- `available_chapters` - массив разделов с их случаями для выбора

### Отправка заявки
```
POST /api/public/leave-services
```

Параметры:
- `chapter` - ID раздела (вместо `option_tree`)
- `case` - ID случая (вместо `instance`)

Старые параметры (`option_tree`, `instance`) все еще поддерживаются для обратной совместимости.

