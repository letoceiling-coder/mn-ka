# Копирование медиа файлов из старого проекта

## Описание

Есть два способа скопировать все медиа файлы (изображения), которые используются в сидере `ProductsServicesOptionsCasesSeeder`:

1. **Команда Artisan** (рекомендуется) - `php artisan media:copy-from-old-project`
2. **Сидер** - `php artisan db:seed --class=CopyMediaFilesSeeder`

## Настройка

Перед запуском убедитесь, что в `.env` настроены параметры подключения к старой БД:

```env
OLD_PROJECT_PATH=C:\OSPanel\domains\lagom
OLD_DB_HOST=127.0.0.1
OLD_DB_PORT=3306
OLD_DB_DATABASE=lagom
OLD_DB_USERNAME=root
OLD_DB_PASSWORD=
```

## Способ 1: Команда Artisan (рекомендуется)

```bash
php artisan media:copy-from-old-project
```

### Преимущества:
- Показывает прогресс-бар
- Более детальная статистика
- Не требует создания записей в БД

## Способ 2: Сидер

```bash
php artisan db:seed --class=CopyMediaFilesSeeder
```

### Преимущества:
- Можно добавить в общий DatabaseSeeder
- Интегрируется с другими сидерами

## Что копируется

Сидер/команда находит и копирует все медиа файлы, которые используются в:

1. **Продукты (Products)**
   - Основные изображения (`image_id`)
   - Иконки (`icon_id`)

2. **Услуги (Services)**
   - Основные изображения (`image_id`)
   - Иконки (`icon_id`)

3. **Кейсы (Cases)**
   - Основные изображения (`image_id`)
   - Иконки (`icon_id`)
   - Изображения из галереи (`cases_image`)

## Структура директорий

Файлы копируются в следующие директории:

- `public/upload/products/` - изображения продуктов
- `public/upload/services/` - изображения услуг
- `public/upload/cases/` - изображения кейсов
- `public/upload/icons/` - иконки (для всех типов сущностей)
- `public/upload/general/` - прочие файлы

## Особенности

- ✅ Автоматическое определение категории файла
- ✅ Пропуск уже существующих файлов
- ✅ Создание директорий при необходимости
- ✅ Поиск файлов по различным путям
- ✅ Обработка ошибок (продолжает работу при отсутствии файлов)

## Примечания

- Файлы копируются **без создания записей в БД** (только физическое копирование)
- Записи в БД создаются при запуске основного сидера `ProductsServicesOptionsCasesSeeder`
- Если файл уже существует, он пропускается (не перезаписывается)

## Рекомендуемый порядок выполнения

1. Сначала скопировать медиа файлы:
   ```bash
   php artisan media:copy-from-old-project
   ```

2. Затем запустить основной сидер:
   ```bash
   php artisan db:seed --class=ProductsServicesOptionsCasesSeeder
   ```

Это гарантирует, что все изображения будут на месте до создания записей в БД.


