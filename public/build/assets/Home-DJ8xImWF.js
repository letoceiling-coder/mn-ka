import{_ as k,r as b,c as z,o as T,e as d,f as g,A as M,h as s,a as D,t as x,w as L,B as A,d as i,m as O,F as j,k as B,z as R,b as $,C as F,T as H,l as S,n as J,i as I,v as N,j as K,g as Z,D as G,x as X}from"./app-DaAEG5wj.js";const Y={name:"HeroBanner",props:{slug:{type:String,default:"home-banner"}},setup(a){const t=b(null),o=b(!0),e=async()=>{try{const n=await fetch(`/api/public/banners/${a.slug}`);if(n.ok){const c=await n.json();c.data&&(t.value={...c.data,background_image:c.data.background_image?`/${c.data.background_image.replace(/^\//,"")}`:null,height_desktop:c.data.height_desktop||380,height_mobile:c.data.height_mobile||300})}}catch(n){console.error("Error fetching banner:",n)}finally{o.value=!1}},m=()=>{t.value.button_type==="method"&&console.log("Method button clicked:",t.value.button_value)},u=z(()=>{if(!t.value)return{};const n=t.value.height_desktop||380,c=t.value.height_mobile||300,p=n-c,y=`(${c}px + ${p} * ((100vw - 320px) / 880))`;return{"--banner-height-mobile":`${c}px`,"--banner-height-desktop":`${n}px`,minHeight:`${c}px`,height:`clamp(${c}px, ${y}, ${n}px)`}});return T(()=>{e()}),{banner:t,loading:o,bannerStyle:u,handleButtonClick:m}}},ee={class:"w-full px-3 sm:px-4 md:px-5 mt-3"},te={class:"w-full max-w-2xl"},se={key:0,class:"space-y-2 sm:space-y-3 mb-6 sm:mb-8"},ne={key:0,class:"text-white text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-semibold leading-tight drop-shadow-lg"},oe={key:1,class:"text-white text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-semibold leading-tight drop-shadow-lg"},ae={key:2,class:"text-white text-lg sm:text-xl md:text-2xl lg:text-3xl font-normal leading-relaxed whitespace-pre-line drop-shadow-md"};function ie(a,t,o,e,m,u){return i(),d("div",ee,[e.banner&&e.banner.is_active?(i(),d("section",{key:0,class:"relative w-full max-w-[1200px] mx-auto rounded-lg overflow-hidden shadow-sm",style:M(e.bannerStyle)},[s("div",{class:"absolute inset-0 bg-cover bg-center bg-no-repeat bg-[#6C7B6D]",style:M({backgroundImage:e.banner.background_image?`url('${e.banner.background_image}')`:"none",backgroundSize:"cover",backgroundPosition:"center"})},null,4),s("div",{class:"relative z-10 w-full px-4 sm:px-6 lg:px-8 h-full flex items-center",style:M(e.bannerStyle)},[s("div",te,[e.banner.heading_1||e.banner.heading_2||e.banner.description?(i(),d("div",se,[e.banner.heading_1?(i(),d("h1",ne,x(e.banner.heading_1),1)):g("",!0),e.banner.heading_2?(i(),d("h2",oe,x(e.banner.heading_2),1)):g("",!0),e.banner.description?(i(),d("p",ae,x(e.banner.description),1)):g("",!0)])):g("",!0),e.banner.button_text?(i(),D(A(e.banner.button_type==="method"?"button":"router-link"),{key:1,to:e.banner.button_type==="url"?e.banner.button_value:void 0,onClick:e.handleButtonClick,class:"inline-block bg-[#657C6C] hover:bg-[#55695a] active:bg-[#48554a] text-white font-medium text-base sm:text-lg px-8 sm:px-10 md:px-12 py-3 sm:py-3.5 md:py-4 rounded-lg transition-all duration-200 transform hover:scale-[1.02] active:scale-100 shadow-lg"},{default:L(()=>[O(x(e.banner.button_text),1)]),_:1},8,["to","onClick"])):g("",!0)])],4)],4)):g("",!0)])}const re=k(Y,[["render",ie]]),le={name:"HowWork",setup(){const a=R(),t=b(null),o=b(!0),e=async()=>{try{const n=await fetch("/api/public/how-work-block/settings");if(n.ok){const c=await n.json();c.data&&(t.value=c.data)}}catch(n){console.error("Error fetching HowWork block settings:",n)}finally{o.value=!1}},m=z(()=>{if(!t.value?.image)return null;const n=t.value.image;return typeof n=="string"?n.startsWith("/")?n:`/${n}`:null}),u=()=>{t.value&&(t.value.button_type==="url"&&t.value.button_value?t.value.button_value.startsWith("http")?window.open(t.value.button_value,"_blank"):a.push(t.value.button_value):t.value.button_type==="method"&&console.log("Method button clicked:",t.value.button_value))};return T(()=>{e()}),{settings:t,loading:o,imageUrl:m,handleButtonClick:u}}},de={key:0,class:"w-full px-3 sm:px-4 md:px-5 py-8 sm:py-12 md:py-16 lg:py-20"},ce={class:"w-full max-w-[1200px] mx-auto"},ue={key:0,class:"flex justify-center mb-8 sm:mb-12"},me={class:"text-2xl sm:text-3xl md:text-4xl font-semibold text-foreground"},fe={class:"flex flex-col md:flex-row gap-6 md:gap-8"},xe={class:"w-full md:w-1/2 order-2 md:order-1"},he={class:"space-y-0"},ge={class:"flex flex-col items-center flex-shrink-0"},be={class:"w-5 h-5 flex-shrink-0"},_e={key:0,width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ve={key:1,width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},pe={key:0,class:"w-0.5 bg-[#306221] flex-1 min-h-[50px] mt-2"},ye={class:"flex-1 pb-6 md:pb-8"},we=["innerHTML"],ke=["innerHTML"],Ce={class:"w-full md:w-1/2 order-1 md:order-2"},qe={key:0,class:"overflow-hidden rounded-[18px] mb-6"},$e=["src","alt"];function Se(a,t,o,e,m,u){return e.settings&&e.settings.is_active?(i(),d("section",de,[s("div",ce,[e.settings.title?(i(),d("div",ue,[s("h2",me,x(e.settings.title),1)])):g("",!0),s("div",fe,[s("div",xe,[s("div",he,[(i(!0),d(j,null,B(e.settings.steps,(n,c)=>(i(),d("div",{key:c,class:"flex gap-4 relative"},[s("div",ge,[s("div",be,[n.point==="disc"?(i(),d("svg",_e,[...t[2]||(t[2]=[s("rect",{width:"20",height:"20",rx:"10",fill:"#6C7B6D"},null,-1)])])):n.point==="star"?(i(),d("svg",ve,[...t[3]||(t[3]=[s("path",{d:"M3.825 20L5.45 12.6053L0 7.63158L7.2 6.97368L10 0L12.8 6.97368L20 7.63158L14.55 12.6053L16.175 20L10 16.0789L3.825 20Z",fill:"#6C7B6D"},null,-1)])])):g("",!0)]),c<e.settings.steps.length-1?(i(),d("div",pe)):g("",!0)]),s("div",ye,[n.title?(i(),d("h3",{key:0,class:"text-base sm:text-lg font-medium text-[#424448] leading-[22px] mb-2",innerHTML:n.title},null,8,we)):g("",!0),n.description?(i(),d("p",{key:1,class:"text-sm sm:text-base font-normal text-[#424448] leading-[20px]",innerHTML:n.description},null,8,ke)):g("",!0)])]))),128))]),e.settings.button_text?(i(),d("button",{key:0,onClick:t[0]||(t[0]=(...n)=>e.handleButtonClick&&e.handleButtonClick(...n)),class:"mt-6 w-full md:hidden px-6 py-3 bg-[#6C7B6D] hover:bg-[#55695a] text-white font-medium rounded-lg transition-colors"},x(e.settings.button_text),1)):g("",!0)]),s("div",Ce,[e.settings.image&&e.imageUrl?(i(),d("div",qe,[s("img",{src:e.imageUrl,alt:e.settings.image_alt||"Как мы работаем",class:"w-full h-auto object-cover"},null,8,$e)])):g("",!0),e.settings.button_text?(i(),d("button",{key:1,onClick:t[1]||(t[1]=(...n)=>e.handleButtonClick&&e.handleButtonClick(...n)),class:"hidden md:block w-full px-6 py-3 bg-[#6C7B6D] hover:bg-[#55695a] text-white font-medium rounded-lg transition-colors"},x(e.settings.button_text),1)):g("",!0)])])])])):g("",!0)}const je=k(le,[["render",Se],["__scopeId","data-v-945e11be"]]),ze={name:"DecisionCard",props:{decision:{type:Object,required:!0},slug:{type:String,default:"products"}}},Ie={class:"flex flex-col justify-between h-[82px] p-3 bg-[#F4F4F4] rounded-lg transition-all duration-200 hover:shadow-md hover:bg-gray-50"},De={class:"name text-sm sm:text-base font-normal text-gray-900 leading-tight mb-2"};function Le(a,t,o,e,m,u){const n=$("router-link");return i(),D(n,{to:`/${o.slug}${o.decision.slug}`,class:"block"},{default:L(()=>[s("div",Ie,[s("div",De,x(o.decision.name),1),t[0]||(t[0]=s("div",{class:"flex items-center justify-end gap-2"},[s("span",{class:"text-xs sm:text-sm font-normal text-[#688E67]"},"подробнее"),s("svg",{width:"16",height:"8",viewBox:"0 0 16 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M15.3536 4.35355C15.5488 4.15829 15.5488 3.84171 15.3536 3.64645L12.1716 0.464465C11.9763 0.269203 11.6597 0.269203 11.4645 0.464465C11.2692 0.659727 11.2692 0.97631 11.4645 1.17157L14.2929 4L11.4645 6.82843C11.2692 7.02369 11.2692 7.34027 11.4645 7.53553C11.6597 7.7308 11.9763 7.7308 12.1716 7.53553L15.3536 4.35355ZM0 4L4.37114e-08 4.5L15 4.5L15 4L15 3.5L-4.37114e-08 3.5L0 4Z",fill:"#688E67"})])],-1))])]),_:1},8,["to"])}const Be=k(ze,[["render",Le]]),Ne={name:"Decisions",components:{DecisionCard:Be,Transition:H,TransitionGroup:F},setup(){const a=b("Выберите решение под ваш участок"),t=b([]),o=b(!0),e=b(null),m=async()=>{try{const h=await fetch("/api/public/decision-block/settings");if(!h.ok)throw new Error("Ошибка загрузки настроек");const y=await h.json();y.data&&y.data.title&&(a.value=y.data.title)}catch(h){console.error("Ошибка загрузки настроек:",h)}},u=async()=>{o.value=!0,e.value=null;try{const h=await fetch("/api/public/decision-block/chapters");if(!h.ok)throw new Error("Ошибка загрузки данных");const E=(await h.json()).data||[];t.value=E.map((C,Q)=>({id:C.id,name:C.name,active:Q===0,items:[...(C.products||[]).map(q=>({...q,category:"products"})),...(C.services||[]).map(q=>({...q,category:"services"}))]})),t.value.length>0&&!t.value.find(C=>C.active)&&(t.value[0].active=!0)}catch(h){console.error("Ошибка загрузки разделов:",h),e.value="Не удалось загрузить данные. Попробуйте обновить страницу."}finally{o.value=!1}},n=z(()=>t.value.find(h=>h.active)||t.value[0]),c=z(()=>n.value?.items||[]),p=h=>{t.value.forEach(y=>{y.active=y.id===h.id})};return T(async()=>{await Promise.all([m(),u()])}),{title:a,chapters:t,activeChapter:n,activeItems:c,setActiveChapter:p,loading:o,error:e}}},Te={class:"w-full px-3 sm:px-4 md:px-5 mt-8 sm:mt-12"},Ee={class:"w-full max-w-[1200px] mx-auto"},Qe={class:"flex justify-center mb-6 sm:mb-8"},Me={class:"text-2xl sm:text-3xl md:text-4xl font-semibold text-gray-900"},He={key:0,class:"flex justify-center items-center py-12"},Ve={key:1,class:"flex justify-center items-center py-12"},Ae={class:"text-red-500"},Oe={key:0,class:"flex flex-col sm:flex-row gap-3 sm:gap-0 mb-6 sm:mb-8"},Fe=["onClick"];function Ue(a,t,o,e,m,u){const n=$("DecisionCard");return i(),d("div",Te,[s("div",Ee,[s("div",Qe,[s("h2",Me,x(e.title),1)]),e.loading?(i(),d("div",He,[...t[0]||(t[0]=[s("div",{class:"text-gray-500"},"Загрузка...",-1)])])):e.error?(i(),d("div",Ve,[s("div",Ae,x(e.error),1)])):(i(),d(j,{key:2},[e.chapters.length>0?(i(),d("div",Oe,[(i(!0),d(j,null,B(e.chapters,(c,p)=>(i(),d("button",{key:c.id,onClick:h=>e.setActiveChapter(c),class:J(["flex-1 px-4 sm:px-6 py-2.5 sm:py-3 text-sm sm:text-base font-normal text-center transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-offset-2","rounded-lg sm:rounded-none",c.active?"bg-[#657C6C] text-white border border-[#657C6C] hover:bg-[#55695a] focus:ring-[#657C6C] shadow-md":"bg-white text-black border border-[#657C6C] hover:bg-[#D7D7D7] focus:ring-[#657C6C] shadow-sm",p===0?c.active?"sm:rounded-l-lg sm:rounded-r-none":"sm:rounded-l-lg sm:rounded-r-none sm:border-r-0":"",p===e.chapters.length-1?c.active?"sm:rounded-r-lg sm:rounded-l-none":"sm:rounded-r-lg sm:rounded-l-none sm:border-l-0":""])},x(c.name),11,Fe))),128))])):g("",!0),S(H,{name:"fade-slide",mode:"out-in"},{default:L(()=>[e.activeItems.length>0?(i(),d("div",{key:`content-${e.activeChapter?.id}`,class:"relative"},[S(F,{name:"stagger",tag:"div",class:"grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6"},{default:L(()=>[(i(!0),d(j,null,B(e.activeItems,(c,p)=>(i(),D(n,{key:`${c.id}-${c.category}-${e.activeChapter?.id}`,decision:c,slug:c.category==="products"?"products":"services"},null,8,["decision","slug"]))),128))]),_:1})])):(i(),d("div",{key:`empty-${e.activeChapter?.id}`,class:"flex justify-center items-center py-12"},[...t[1]||(t[1]=[s("div",{class:"text-gray-500"},"В этом разделе пока нет элементов",-1)])]))]),_:1})],64))])])}const We=k(Ne,[["render",Ue],["__scopeId","data-v-9be57a33"]]),Pe={name:"ImagesCollect",props:{data:{type:Object,required:!0},numberQuestion:{type:Number,required:!0}},emits:["next","answer"],methods:{handleSelect(a){const t={id:a.id||a.name,name:a.name||"",title:a.title||a.name||"",text:a.title||a.name||"",src:a.src||a.webp||""};this.$emit("answer",t),a.child?setTimeout(()=>{this.$emit("next",a.child)},300):setTimeout(()=>{this.$emit("next")},300)},handleImageError(a){a.target.src="/upload/quiz/placeholder.jpg"}}},Re={class:"mt-6"},Je={class:"flex items-center gap-3 sm:gap-4 mb-6 px-2"},Ke={class:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-[#657C6C] text-white font-semibold text-lg sm:text-xl flex-shrink-0"},Ze={class:"question text-lg sm:text-xl md:text-2xl font-medium text-gray-900"},Ge={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4"},Xe=["onClick"],Ye={class:"relative aspect-[245/140] sm:aspect-[245/140] rounded-2xl overflow-hidden shadow-md hover:shadow-lg transition-all duration-300 transform hover:scale-105"},et=["src","alt"],tt={class:"absolute top-3 left-3 right-3 z-10"},st={class:"text-white font-medium text-base sm:text-lg md:text-xl drop-shadow-lg"};function nt(a,t,o,e,m,u){return i(),d("div",Re,[s("div",Je,[s("div",Ke,x(o.data.id),1),s("div",Ze,x(o.data.question),1)]),s("div",Ge,[(i(!0),d(j,null,B(o.data.selects,n=>(i(),d("div",{key:n.id,class:"relative group cursor-pointer",onClick:c=>u.handleSelect(n)},[s("div",Ye,[s("img",{src:n.src||n.webp||"/upload/quiz/placeholder.jpg",alt:n.name||n.title,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",onError:t[0]||(t[0]=(...c)=>u.handleImageError&&u.handleImageError(...c))},null,40,et),t[1]||(t[1]=s("div",{class:"absolute inset-0 bg-gradient-to-b from-black/60 via-black/20 to-transparent pointer-events-none"},null,-1)),s("div",tt,[s("h3",st,x(n.title),1)])])],8,Xe))),128))])])}const ot=k(Pe,[["render",nt]]),at={name:"Selects",props:{data:{type:Object,required:!0},numberQuestion:{type:Number,required:!0}},emits:["next","answer"],methods:{handleSelect(a){const t={id:a.id||a.name,name:a.name||"",title:a.title||a.name||"",text:a.name||a.title||""};this.$emit("answer",t),setTimeout(()=>{this.$emit("next")},300)}}},it={class:"mt-6"},rt={class:"flex items-center gap-3 sm:gap-4 mb-6 px-2"},lt={class:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-[#657C6C] text-white font-semibold text-lg sm:text-xl flex-shrink-0"},dt={class:"question text-lg sm:text-xl md:text-2xl font-medium text-gray-900"},ct={class:"space-y-3 sm:space-y-4 max-w-2xl"},ut=["onClick"];function mt(a,t,o,e,m,u){return i(),d("div",it,[s("div",rt,[s("div",lt,x(o.data.id),1),s("div",dt,x(o.data.question),1)]),s("div",ct,[(i(!0),d(j,null,B(o.data.selects,n=>(i(),d("button",{key:n.id,onClick:c=>u.handleSelect(n),class:"w-full px-6 py-4 text-left bg-white border-2 border-gray-200 rounded-lg hover:border-[#657C6C] hover:bg-gray-50 transition-all duration-200 text-base sm:text-lg font-normal text-gray-900 focus:outline-none focus:ring-2 focus:ring-[#657C6C] focus:ring-offset-2"},x(n.name),9,ut))),128))])])}const ft=k(at,[["render",mt]]),xt={name:"Inputs",props:{data:{type:Object,required:!0},numberQuestion:{type:Number,required:!0}},emits:["next","answer"],setup(a,{emit:t}){const o=b(a.data?.answer||""),e=z(()=>{const u=o.value;return u==null?!1:u.toString().trim()!==""});return{answerValue:o,isAnswerValid:e,handleNext:()=>{const u=o.value?.toString().trim()||"";u&&(a.data&&(a.data.answer=u),t("answer",u),a.data?.child?t("next",a.data.child):t("next"))}}}},ht={class:"mt-6"},gt={class:"flex items-center gap-3 sm:gap-4 mb-6 px-2"},bt={class:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-[#657C6C] text-white font-semibold text-lg sm:text-xl flex-shrink-0"},_t={class:"question text-lg sm:text-xl md:text-2xl font-medium text-gray-900"},vt={class:"max-w-2xl"},pt={class:"block text-sm font-medium text-gray-700 mb-2"},yt={class:"flex flex-col sm:flex-row gap-3 sm:gap-4"},wt=["placeholder"],kt=["disabled"];function Ct(a,t,o,e,m,u){return i(),d("div",ht,[s("div",gt,[s("div",bt,x(o.data.id),1),s("div",_t,x(o.data.question),1)]),s("div",vt,[s("label",pt,x(o.data.label),1),s("div",yt,[I(s("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>e.answerValue=n),type:"text",placeholder:o.data.placeholder,onKeyup:t[1]||(t[1]=K((...n)=>e.handleNext&&e.handleNext(...n),["enter"])),class:"flex-1 w-full rounded-md border border-gray-300 bg-white px-4 py-3 text-sm sm:text-base transition-colors disabled:opacity-50 focus:border-[#657C6C] focus:ring-2 focus:ring-[#657C6C]/20 focus:outline-none"},null,40,wt),[[N,e.answerValue]]),s("button",{onClick:t[2]||(t[2]=(...n)=>e.handleNext&&e.handleNext(...n)),disabled:!e.isAnswerValid,class:"px-6 sm:px-8 py-3 bg-[#657C6C] hover:bg-[#55695a] disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[#657C6C] focus:ring-offset-2"}," Далее ",8,kt)])])])}const qt=k(xt,[["render",Ct]]),$t={name:"Forms",props:{data:{type:Object,required:!0},numberQuestion:{type:Number,required:!0}},emits:["next","answer"],computed:{isFormValid(){return this.data.form.name&&this.data.form.name.trim()!==""&&this.data.form.email&&this.data.form.email.trim()!==""&&this.data.form.phone&&this.data.form.phone.trim()!==""&&this.data.form.check}},methods:{async handleSubmit(){this.isFormValid&&(this.$emit("answer",this.data.form),this.$emit("submit",{name:this.data.form.name,email:this.data.form.email,phone:this.data.form.phone}))}}},St={class:"mt-6"},jt={class:"mb-6 px-2"},zt=["innerHTML"],It={class:"max-w-2xl"},Dt={class:"flex items-start"},Lt=["disabled"];function Bt(a,t,o,e,m,u){return i(),d("div",St,[s("div",jt,[s("div",{class:"question text-lg sm:text-xl md:text-2xl font-medium text-gray-900",innerHTML:o.data.question},null,8,zt)]),s("div",It,[s("form",{onSubmit:t[4]||(t[4]=Z((...n)=>u.handleSubmit&&u.handleSubmit(...n),["prevent"])),class:"space-y-4"},[s("div",null,[t[5]||(t[5]=s("label",{for:"quiz-name",class:"block text-sm font-medium text-gray-700 mb-2"}," Ваше имя ",-1)),I(s("input",{id:"quiz-name","onUpdate:modelValue":t[0]||(t[0]=n=>o.data.form.name=n),type:"text",required:"",class:"w-full rounded-md border border-gray-300 bg-white px-4 py-3 text-sm sm:text-base transition-colors focus:border-[#657C6C] focus:ring-2 focus:ring-[#657C6C]/20 focus:outline-none",placeholder:"Иван Иванов"},null,512),[[N,o.data.form.name]])]),s("div",null,[t[6]||(t[6]=s("label",{for:"quiz-email",class:"block text-sm font-medium text-gray-700 mb-2"}," Ваш email ",-1)),I(s("input",{id:"quiz-email","onUpdate:modelValue":t[1]||(t[1]=n=>o.data.form.email=n),type:"email",required:"",class:"w-full rounded-md border border-gray-300 bg-white px-4 py-3 text-sm sm:text-base transition-colors focus:border-[#657C6C] focus:ring-2 focus:ring-[#657C6C]/20 focus:outline-none",placeholder:"your@email.com"},null,512),[[N,o.data.form.email]])]),s("div",null,[t[7]||(t[7]=s("label",{for:"quiz-phone",class:"block text-sm font-medium text-gray-700 mb-2"}," Ваш телефон ",-1)),I(s("input",{id:"quiz-phone","onUpdate:modelValue":t[2]||(t[2]=n=>o.data.form.phone=n),type:"tel",required:"",class:"w-full rounded-md border border-gray-300 bg-white px-4 py-3 text-sm sm:text-base transition-colors focus:border-[#657C6C] focus:ring-2 focus:ring-[#657C6C]/20 focus:outline-none",placeholder:"+7 (999) 123-45-67"},null,512),[[N,o.data.form.phone]])]),s("div",Dt,[I(s("input",{id:"quiz-check","onUpdate:modelValue":t[3]||(t[3]=n=>o.data.form.check=n),type:"checkbox",required:"",class:"mt-1 h-4 w-4 rounded border-gray-300 text-[#657C6C] focus:ring-[#657C6C] focus:ring-2"},null,512),[[G,o.data.form.check]]),t[8]||(t[8]=s("label",{for:"quiz-check",class:"ml-3 text-sm text-gray-600"}," Отправляя данную форму, вы соглашаетесь на обработку персональных данных ",-1))]),s("button",{type:"submit",disabled:!u.isFormValid,class:"w-full sm:w-auto px-8 py-3 bg-[#657C6C] hover:bg-[#55695a] disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[#657C6C] focus:ring-offset-2"}," Отправить ",8,Lt)],32)])])}const Nt=k($t,[["render",Bt]]),Tt={name:"Thank",props:{data:{type:Object,default:()=>({})},numberQuestion:{type:Number,required:!0}}},Et={class:"mt-6"};function Qt(a,t,o,e,m,u){return i(),d("div",Et,[...t[0]||(t[0]=[X('<div class="flex flex-col items-center justify-center py-8 sm:py-12 px-4"><div class="w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-green-100 flex items-center justify-center mb-6"><svg class="w-8 h-8 sm:w-10 sm:h-10 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div><h3 class="text-xl sm:text-2xl md:text-3xl font-semibold text-gray-900 text-center mb-4"> Спасибо! </h3><p class="text-base sm:text-lg text-gray-600 text-center max-w-md"> Наши специалисты свяжутся с вами в течение 15 минут </p></div>',1)])])}const Mt=k(Tt,[["render",Qt]]),Ht={name:"Quiz",components:{"images-collect":ot,selects:ft,inputs:qt,forms:Nt,thank:Mt},props:{title:{type:String,default:"Подберите идеальное решение"},description:{type:String,default:"Ответьте на несколько вопросов, и мы предложим оптимальный вариант"}},setup(){const a=b(!0),t=b(null),o=b(null),e=b([]),m=b(1),u=b([]),n=b(!1),c=b({}),p=b(!1),h=b(!1),y=async()=>{try{const r=await fetch("/api/public/quiz-block/settings");if(!r.ok)throw new Error("Ошибка загрузки настроек");const l=await r.json();l.data?(n.value=l.data.is_active===!0,l.data.quiz_id?await E(l.data.quiz_id):a.value=!1):a.value=!1}catch(r){console.error("Ошибка загрузки настроек блока квиза:",r),a.value=!1}},E=async r=>{a.value=!0,t.value=null;try{const l=await fetch(`/api/public/quiz-block/quiz/${r}`);if(!l.ok)throw new Error("Ошибка загрузки квиза");const f=await l.json();f.data&&(o.value={id:f.data.id,title:f.data.title,description:f.data.description},e.value=(f.data.questions||[]).filter(_=>_.is_active!==!1).sort((_,v)=>(_.order||0)-(v.order||0)).map((_,v)=>({..._,displayId:v+1})),e.value.length>0&&(m.value=e.value[0].displayId,u.value=[]))}catch(l){t.value=l.message||"Ошибка загрузки квиза",console.error("Ошибка загрузки квиза:",l)}finally{a.value=!1}},C=r=>{const l={id:r.displayId||r.id||r.order,question:r.question_text||"",type:r.question_type,...r.question_data||{}};return(r.question_type==="images-collect"||r.question_type==="selects")&&r.question_data?.selects&&(l.selects=r.question_data.selects.map((f,_)=>({id:f.id||_+1,name:f.name||"",src:f.src||"",title:f.title||f.name||"",child:f.child||null}))),r.question_type==="inputs"&&r.question_data&&(l.label=r.question_data.label||"",l.placeholder=r.question_data.placeholder||"",l.child=r.question_data.child||null,l.answer=""),r.question_type==="forms"&&r.question_data&&(l.form=r.question_data.form||{name:"",email:"",phone:"",check:!1},l.child=r.question_data.child||null,l.question=r.question_text||r.question_data.question||""),l},Q=z(()=>e.value.find(r=>r.displayId===m.value)),q=r=>{const l=m.value;if(l&&!u.value.includes(l)&&u.value.push(l),r){const f=e.value.findIndex(_=>_.displayId===m.value);r>0&&r<=e.value.length?m.value=r:f<e.value.length-1&&(m.value=e.value[f+1].displayId)}else{const f=e.value.findIndex(_=>_.displayId===m.value);f<e.value.length-1&&(m.value=e.value[f+1].displayId)}},U=()=>{const r=e.value.findIndex(l=>l.displayId===m.value);if(r>0){const l=e.value[r-1];if(l){const f=u.value.lastIndexOf(m.value);f!==-1&&(u.value=u.value.slice(0,f)),m.value=l.displayId}}},W=r=>{const l=e.value.find(f=>f.displayId===m.value);l&&(c.value[l.id]={question_id:l.id,question_text:l.question_text,question_type:l.question_type,answer:r})},V=async r=>{if(!(h.value||p.value)){h.value=!0;try{const l=e.value.filter(w=>c.value[w.id]).map(w=>c.value[w.id].answer),f=await fetch("/api/public/quiz/submit",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({quiz_id:o.value.id,answers:l,contact:r})});let _="",v=null;try{if(_=await f.text(),_)try{v=JSON.parse(_)}catch(w){throw console.error("Ошибка парсинга JSON:",w,"Response text:",_.substring(0,200)),new Error("Сервер вернул некорректный ответ. Пожалуйста, попробуйте еще раз.")}}catch(w){throw console.error("Ошибка чтения ответа:",w),new Error("Ошибка получения ответа от сервера")}if(!f.ok){const w=v&&v.message||v&&v.error||`Ошибка сервера: ${f.status} ${f.statusText}`;throw new Error(w)}if(!v)throw console.error("Сервер вернул пустой ответ. Response text:",_.substring(0,200)),new Error("Сервер вернул пустой ответ");if(typeof v!="object")throw console.error("Сервер вернул некорректный тип данных:",typeof v,v),new Error("Сервер вернул некорректный ответ");if(v.success===!0)return p.value=!0,{success:!0,message:v.message||"Спасибо за прохождение квиза!"};{const w=v.message||v.error||"Ошибка отправки результатов квиза";throw new Error(w)}}catch(l){return console.error("Ошибка отправки результатов квиза:",l),{success:!1,message:l.message||"Ошибка отправки результатов квиза. Пожалуйста, попробуйте еще раз."}}finally{h.value=!1}}},P=async r=>{const l=await V(r);l.success?q():alert(l.message||"Произошла ошибка при отправке результатов. Пожалуйста, попробуйте еще раз.")};return T(()=>{y()}),{loading:a,error:t,quizData:o,questions:e,currentQuestionNumber:m,currentQuestion:Q,isActive:n,isCompleted:p,isSubmitting:h,formatQuestionData:C,goToNext:q,goToPrevious:U,handleAnswer:W,handleSubmit:P,submitQuiz:V,questionHistory:u}}},Vt={key:0,class:"w-full px-3 sm:px-4 md:px-5 mt-8 sm:mt-12 mb-8 sm:mb-12"},At={class:"w-full max-w-[1200px] mx-auto"},Ot={class:"flex flex-col items-center mb-6 sm:mb-8"},Ft={class:"text-2xl sm:text-3xl md:text-4xl font-semibold text-gray-900 text-center mb-3"},Ut={key:0,class:"text-gray-600 text-center text-base sm:text-lg"},Wt={key:0,class:"flex justify-center items-center py-12"},Pt={key:1,class:"flex justify-center items-center py-12"},Rt={class:"text-red-500"},Jt={key:0,class:"mb-4"};function Kt(a,t,o,e,m,u){return e.isActive?(i(),d("div",Vt,[s("div",At,[s("div",Ot,[s("h2",Ft,x(e.quizData?.title||o.title),1),e.quizData?.description||o.description?(i(),d("p",Ut,x(e.quizData?.description||o.description),1)):g("",!0)]),e.loading?(i(),d("div",Wt,[...t[1]||(t[1]=[s("div",{class:"text-gray-500"},"Загрузка квиза...",-1)])])):e.error?(i(),d("div",Pt,[s("div",Rt,x(e.error),1)])):e.currentQuestion?(i(),D(H,{key:2,name:"quiz-fade",mode:"out-in"},{default:L(()=>[s("div",null,[e.questionHistory.length>0||e.currentQuestionNumber>1?(i(),d("div",Jt,[s("button",{onClick:t[0]||(t[0]=(...n)=>e.goToPrevious&&e.goToPrevious(...n)),class:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors text-sm sm:text-base"},[...t[2]||(t[2]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),O(" Назад ",-1)])])])):g("",!0),(i(),D(A(e.currentQuestion.question_type),{key:e.currentQuestion.id,data:e.formatQuestionData(e.currentQuestion),"number-question":e.currentQuestion.id,onNext:e.goToNext,onAnswer:e.handleAnswer,onSubmit:e.handleSubmit},null,40,["data","number-question","onNext","onAnswer","onSubmit"]))])]),_:1})):g("",!0)])])):g("",!0)}const Zt=k(Ht,[["render",Kt],["__scopeId","data-v-0991a741"]]),Gt={name:"Home",components:{HeroBanner:re,HowWork:je,Decisions:We,Quiz:Zt}},Xt={class:"home-page"};function Yt(a,t,o,e,m,u){const n=$("HeroBanner"),c=$("Decisions"),p=$("Quiz"),h=$("HowWork");return i(),d("div",Xt,[S(n),S(c),S(p),S(h)])}const ts=k(Gt,[["render",Yt]]);export{ts as default};
