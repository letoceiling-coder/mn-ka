import{_ as b,c as a,b as t,d as u,t as g,p as f,v as p,D as x,u as y,h as l,j as w,o as d}from"./app-nyV1LXZ4.js";import{a as k,b as _}from"./api-V9GPpd21.js";import{S as v}from"./sweetalert2.esm.all-C0u8rGqG.js";const S={name:"DecisionSettings",setup(){const i=l(!1),e=l(!1),r=l(null),s=l({title:"Выберите решение под ваш участок",columns:3,is_active:!0}),c=async()=>{i.value=!0,r.value=null;try{const o=await k("/decision-block-settings");if(!o.ok)throw new Error("Ошибка загрузки настроек");const n=await o.json();n.data&&(s.value={title:n.data.title||"Выберите решение под ваш участок",columns:n.data.columns||3,is_active:n.data.is_active!==!1})}catch(o){r.value=o.message||"Ошибка загрузки настроек",console.error("Error fetching settings:",o)}finally{i.value=!1}},m=async()=>{e.value=!0,r.value=null;try{const o=await _("/decision-block-settings",s.value);if(!o.ok){const n=await o.json().catch(()=>({}));throw new Error(n.message||"Ошибка сохранения настроек")}await v.fire({title:"Настройки сохранены",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"})}catch(o){r.value=o.message||"Ошибка сохранения настроек",await v.fire({title:"Ошибка",text:o.message||"Ошибка сохранения настроек",icon:"error",confirmButtonText:"ОК"})}finally{e.value=!1}};return w(()=>{c()}),{loading:i,saving:e,error:r,form:s,fetchSettings:c,saveSettings:m}}},h={class:"settings-page space-y-6"},j={key:0,class:"flex items-center justify-center py-12"},B={key:1,class:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg"},D={class:"text-destructive"},V={key:2,class:"bg-card rounded-lg border border-border p-6 space-y-6"},C={class:"space-y-4"},E={class:"flex items-center gap-2"},M={class:"flex justify-end gap-3 pt-4 border-t border-border"},U=["disabled"];function N(i,e,r,s,c,m){return d(),a("div",h,[e[9]||(e[9]=t("div",{class:"flex items-center justify-between"},[t("div",null,[t("h1",{class:"text-3xl font-semibold text-foreground"},"Настройки блока"),t("p",{class:"text-muted-foreground mt-1"},'Настройки блока "Решения"')])],-1)),s.loading?(d(),a("div",j,[...e[4]||(e[4]=[t("p",{class:"text-muted-foreground"},"Загрузка настроек...",-1)])])):u("",!0),s.error?(d(),a("div",B,[t("p",D,g(s.error),1)])):u("",!0),s.loading?u("",!0):(d(),a("div",V,[t("div",C,[t("div",null,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Заголовок блока ",-1)),f(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>s.form.title=o),type:"text",class:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent",placeholder:"Выберите решение под ваш участок"},null,512),[[p,s.form.title]])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Количество колонок ",-1)),f(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>s.form.columns=o),class:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent"},[...e[6]||(e[6]=[t("option",{value:1},"1 колонка",-1),t("option",{value:2},"2 колонки",-1),t("option",{value:3},"3 колонки",-1),t("option",{value:4},"4 колонки",-1)])],512),[[x,s.form.columns]])]),t("div",E,[f(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.form.is_active=o),type:"checkbox",id:"is_active",class:"w-4 h-4 rounded border-border"},null,512),[[y,s.form.is_active]]),e[8]||(e[8]=t("label",{for:"is_active",class:"text-sm font-medium text-foreground"}," Блок активен ",-1))])]),t("div",M,[t("button",{onClick:e[3]||(e[3]=(...o)=>s.saveSettings&&s.saveSettings(...o)),disabled:s.saving,class:"px-6 py-2 bg-accent hover:bg-accent/90 text-white rounded-lg transition-colors disabled:opacity-50"},g(s.saving?"Сохранение...":"Сохранить настройки"),9,U)])]))])}const q=b(S,[["render",N]]);export{q as default};
