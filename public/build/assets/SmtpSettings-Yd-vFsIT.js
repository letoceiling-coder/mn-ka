import{_ as P,c as g,b as t,d as f,t as x,l as r,G as T,D as y,v as n,h as d,j as V,J as v,o as p}from"./app-B_qSWCTG.js";import{S as a}from"./sweetalert2.esm.all-C0u8rGqG.js";const U={name:"SmtpSettings",setup(){const m=d(!0),e=d(!1),u=d(!1),s=d(null),b=d(null),i=d(""),o=d(""),w=async()=>{m.value=!0,s.value=null;try{const l=await v.get("/api/v1/smtp-settings");b.value=l.data.data,i.value=""}catch(l){s.value=l.response?.data?.message||"Ошибка загрузки настроек",console.error("Error fetching SMTP settings:",l)}finally{m.value=!1}},S=async()=>{e.value=!0,s.value=null;try{const l={...b.value};i.value&&(l.password=i.value),await v.put("/api/v1/smtp-settings",l),i.value="",await a.fire({icon:"success",title:"Успешно!",text:"Настройки SMTP успешно сохранены.",timer:2e3,showConfirmButton:!1})}catch(l){s.value=l.response?.data?.message||"Ошибка сохранения настроек",await a.fire({icon:"error",title:"Ошибка",text:s.value})}finally{e.value=!1}},k=async()=>{if(!o.value){await a.fire({icon:"warning",title:"Внимание",text:"Введите email адрес для теста"});return}u.value=!0,s.value=null;try{await v.post("/api/v1/smtp-settings/test",{email:o.value}),await a.fire({icon:"success",title:"Успешно!",html:`Тестовое письмо отправлено на <strong>${o.value}</strong><br><br>Проверьте почтовый ящик.`,timer:4e3})}catch(l){const M=l.response?.data?.message||"Ошибка при отправке тестового письма",c=l.response?.data?.error?.message||"";await a.fire({icon:"error",title:"Ошибка отправки",html:`<p>${M}</p>${c?`<p class="text-xs mt-2">${c}</p>`:""}`})}finally{u.value=!1}};return V(()=>{w()}),{loading:m,saving:e,testing:u,error:s,settings:b,password:i,testEmail:o,saveSettings:S,testSmtp:k}}},E={class:"smtp-settings-page space-y-6"},C={key:0,class:"flex items-center justify-center py-12"},j={key:1,class:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg"},B={class:"text-destructive"},D={key:2,class:"space-y-6"},N={class:"bg-card rounded-lg border border-border p-6 space-y-6"},F={class:"flex items-center justify-between"},L={class:"flex items-center gap-2"},z={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},A={class:"bg-card rounded-lg border border-border p-6 space-y-4"},G={class:"flex gap-3 items-end"},H={class:"flex-1"},J=["disabled"],q={class:"flex justify-end"},I=["disabled"];function K(m,e,u,s,b,i){return p(),g("div",E,[e[29]||(e[29]=t("div",null,[t("h1",{class:"text-3xl font-semibold text-foreground"},"Настройки SMTP"),t("p",{class:"text-muted-foreground mt-1"}," Настройка параметров SMTP сервера для отправки почты ")],-1)),s.loading?(p(),g("div",C,[...e[12]||(e[12]=[t("p",{class:"text-muted-foreground"},"Загрузка настроек...",-1)])])):f("",!0),s.error?(p(),g("div",j,[t("p",B,x(s.error),1)])):f("",!0),!s.loading&&s.settings?(p(),g("div",D,[t("div",N,[t("div",F,[e[14]||(e[14]=t("h2",{class:"text-xl font-semibold text-foreground"},"Параметры SMTP",-1)),t("div",L,[r(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=o=>s.settings.is_active=o),id:"is_active",class:"w-4 h-4 rounded border-border"},null,512),[[T,s.settings.is_active]]),e[13]||(e[13]=t("label",{for:"is_active",class:"text-sm font-medium text-foreground cursor-pointer"}," Использовать эти настройки ",-1))])]),t("div",z,[t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Mailer ",-1)),r(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>s.settings.mailer=o),class:"w-full h-10 px-3 border border-border rounded bg-background text-sm"},[...e[15]||(e[15]=[t("option",{value:"smtp"},"SMTP",-1),t("option",{value:"sendmail"},"Sendmail",-1),t("option",{value:"mailgun"},"Mailgun",-1),t("option",{value:"ses"},"Amazon SES",-1)])],512),[[y,s.settings.mailer]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," SMTP Host ",-1)),r(t("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=o=>s.settings.host=o),placeholder:"smtp.beget.com",class:"w-full h-10 px-3 border border-border rounded bg-background text-sm"},null,512),[[n,s.settings.host]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," SMTP Port ",-1)),r(t("input",{type:"number","onUpdate:modelValue":e[3]||(e[3]=o=>s.settings.port=o),placeholder:"465",class:"w-full h-10 px-3 border border-border rounded bg-background text-sm"},null,512),[[n,s.settings.port,void 0,{number:!0}]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Шифрование ",-1)),r(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>s.settings.encryption=o),class:"w-full h-10 px-3 border border-border rounded bg-background text-sm"},[...e[19]||(e[19]=[t("option",{value:"ssl"},"SSL",-1),t("option",{value:"tls"},"TLS",-1),t("option",{value:""},"Нет",-1)])],512),[[y,s.settings.encryption]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Username (Email) ",-1)),r(t("input",{type:"email","onUpdate:modelValue":e[5]||(e[5]=o=>s.settings.username=o),placeholder:"info@proffi-center.ru",class:"w-full h-10 px-3 border border-border rounded bg-background text-sm"},null,512),[[n,s.settings.username]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Password ",-1)),r(t("input",{type:"password","onUpdate:modelValue":e[6]||(e[6]=o=>s.password=o),placeholder:"Введите пароль (оставьте пустым чтобы не менять)",class:"w-full h-10 px-3 border border-border rounded bg-background text-sm"},null,512),[[n,s.password]]),e[23]||(e[23]=t("p",{class:"text-xs text-muted-foreground mt-1"}," Оставьте пустым, чтобы не изменять текущий пароль ",-1))]),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," From Email ",-1)),r(t("input",{type:"email","onUpdate:modelValue":e[7]||(e[7]=o=>s.settings.from_email=o),placeholder:"info@proffi-center.ru",class:"w-full h-10 px-3 border border-border rounded bg-background text-sm"},null,512),[[n,s.settings.from_email]])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," From Name ",-1)),r(t("input",{type:"text","onUpdate:modelValue":e[8]||(e[8]=o=>s.settings.from_name=o),placeholder:"mn-ka.ru",class:"w-full h-10 px-3 border border-border rounded bg-background text-sm"},null,512),[[n,s.settings.from_name]])])])]),t("div",A,[e[27]||(e[27]=t("h2",{class:"text-xl font-semibold text-foreground"},"Тестирование SMTP",-1)),e[28]||(e[28]=t("p",{class:"text-sm text-muted-foreground"}," Отправьте тестовое письмо для проверки настроек SMTP ",-1)),t("div",G,[t("div",H,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Email для теста ",-1)),r(t("input",{type:"email","onUpdate:modelValue":e[9]||(e[9]=o=>s.testEmail=o),placeholder:"test@example.com",class:"w-full h-10 px-3 border border-border rounded bg-background text-sm"},null,512),[[n,s.testEmail]])]),t("button",{onClick:e[10]||(e[10]=(...o)=>s.testSmtp&&s.testSmtp(...o)),disabled:s.testing||!s.testEmail,class:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium whitespace-nowrap"},x(s.testing?"Отправка...":"Отправить тест"),9,J)])]),t("div",q,[t("button",{onClick:e[11]||(e[11]=(...o)=>s.saveSettings&&s.saveSettings(...o)),disabled:s.saving,class:"px-6 py-2 bg-accent text-accent-foreground rounded hover:bg-accent/90 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium"},x(s.saving?"Сохранение...":"Сохранить настройки"),9,I)])])):f("",!0)])}const R=P(U,[["render",K]]);export{R as default};
