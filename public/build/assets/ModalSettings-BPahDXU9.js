import{_ as B,c as d,b as e,d as l,t as c,s as k,F as T,k as V,h as u,j as S,o as a,f as w,x as D,l as b,v as y,q as H}from"./app-CgLkxdvy.js";import{a as U,b as z,c as E}from"./api-V9GPpd21.js";import{S as p}from"./sweetalert2.esm.all-C0u8rGqG.js";const N={name:"ModalSettings",setup(){const v=u(!1),t=u(null),f=u(null),o=u(null),g=u([]),x=s=>({products:"Модальное окно продуктов",services:"Модальное окно услуг"})[s]||s,r=s=>({products:"Информационное сообщение, которое отображается в модальном окне на странице продукта",services:"Информационное сообщение, которое отображается в модальном окне на странице услуги"})[s]||"Информационное сообщение для модального окна",i=async()=>{v.value=!0,o.value=null;try{const s=await U("/modal-settings");if(s.ok){const n=await s.json();g.value=n.data||[]}else throw new Error("Ошибка загрузки настроек")}catch(s){o.value=s.message||"Ошибка загрузки настроек модальных окон",console.error("Error fetching modal settings:",s)}finally{v.value=!1}},_=s=>g.value.some(n=>n.type===s),M=async s=>{f.value=s,o.value=null;try{const n={products:"Информация о продукте",services:"Информация об услуге"},m={products:"Здесь будет информация о продукте и услугах.",services:"Здесь будет информация об услуге и параметрах."},h=await E("/modal-settings",{type:s,title:n[s]||"Информация",content:m[s]||"Информационное сообщение",is_active:!0});if(h.ok)await p.fire({title:"Модальное окно создано",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"}),await i();else{const j=await h.json().catch(()=>({}));throw new Error(j.message||"Ошибка создания модального окна")}}catch(n){o.value=n.message||"Ошибка создания модального окна",await p.fire({title:"Ошибка",text:o.value,icon:"error",confirmButtonText:"ОК"})}finally{f.value=null}},C=async s=>{t.value=s.id,o.value=null;try{const n=await z(`/modal-settings/${s.id}`,{type:s.type,title:s.title||null,content:s.content||null,is_active:s.is_active});if(n.ok)await p.fire({title:"Настройки сохранены",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"});else{const m=await n.json().catch(()=>({}));throw new Error(m.message||"Ошибка сохранения настроек")}}catch(n){o.value=n.message||"Ошибка сохранения настроек модального окна",await p.fire({title:"Ошибка",text:o.value,icon:"error",confirmButtonText:"ОК"})}finally{t.value=null}};return S(()=>{i()}),{loading:v,saving:t,creating:f,error:o,modals:g,getModalTitle:x,getModalDescription:r,hasModalType:_,createModal:M,saveModal:C}}},F={class:"modal-settings-page space-y-6"},L={key:0,class:"flex items-center justify-center py-16"},P={key:1,class:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg"},q={class:"flex items-start gap-3"},A={class:"text-destructive"},G={key:2,class:"space-y-6"},I={key:0,class:"bg-card rounded-lg border border-border p-6"},J={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},K=["disabled"],O=["disabled"],Q={class:"flex items-center justify-between"},R={class:"flex-1"},W={class:"text-xl font-semibold text-foreground flex items-center gap-2"},X={class:"text-sm text-muted-foreground mt-1"},Y={class:"space-y-4"},Z=["value"],$=["onUpdate:modelValue"],ee=["onUpdate:modelValue"],te={class:"flex items-center gap-3 p-4 bg-muted/30 rounded-lg"},oe=["onUpdate:modelValue","id"],se=["for"],re={class:"flex justify-end gap-3 pt-4 border-t border-border"},ne=["onClick","disabled"],de={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ae={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ie={key:1,class:"text-center py-12 border-2 border-dashed border-border rounded-lg bg-muted/20"};function le(v,t,f,o,g,x){return a(),d("div",F,[t[14]||(t[14]=e("div",null,[e("h1",{class:"text-3xl font-semibold text-foreground"},"Модальные окна"),e("p",{class:"text-muted-foreground mt-1"},"Управление информационными сообщениями в модальных окнах")],-1)),o.loading?(a(),d("div",L,[...t[2]||(t[2]=[e("div",{class:"flex flex-col items-center gap-4"},[e("div",{class:"w-12 h-12 border-4 border-accent border-t-transparent rounded-full animate-spin"}),e("p",{class:"text-muted-foreground"},"Загрузка настроек...")],-1)])])):l("",!0),o.error?(a(),d("div",P,[e("div",q,[t[3]||(t[3]=e("svg",{class:"w-5 h-5 text-destructive flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("p",A,c(o.error),1)])])):l("",!0),o.loading?l("",!0):(a(),d("div",G,[!o.hasModalType("products")||!o.hasModalType("services")?(a(),d("div",I,[t[6]||(t[6]=e("h2",{class:"text-lg font-semibold text-foreground mb-4"},"Создать модальное окно",-1)),e("div",J,[o.hasModalType("products")?l("",!0):(a(),d("button",{key:0,onClick:t[0]||(t[0]=r=>o.createModal("products")),disabled:o.creating==="products",class:"p-4 border-2 border-dashed border-border rounded-lg hover:border-accent transition-colors text-left"},[...t[4]||(t[4]=[k('<div class="flex items-center gap-3" data-v-f6ae0cd1><svg class="w-6 h-6 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-f6ae0cd1><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" data-v-f6ae0cd1></path></svg><div data-v-f6ae0cd1><p class="font-medium text-foreground" data-v-f6ae0cd1>Модальное окно продуктов</p><p class="text-sm text-muted-foreground" data-v-f6ae0cd1>Создать настройки для продуктов</p></div></div>',1)])],8,K)),o.hasModalType("services")?l("",!0):(a(),d("button",{key:1,onClick:t[1]||(t[1]=r=>o.createModal("services")),disabled:o.creating==="services",class:"p-4 border-2 border-dashed border-border rounded-lg hover:border-accent transition-colors text-left"},[...t[5]||(t[5]=[k('<div class="flex items-center gap-3" data-v-f6ae0cd1><svg class="w-6 h-6 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-f6ae0cd1><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" data-v-f6ae0cd1></path></svg><div data-v-f6ae0cd1><p class="font-medium text-foreground" data-v-f6ae0cd1>Модальное окно услуг</p><p class="text-sm text-muted-foreground" data-v-f6ae0cd1>Создать настройки для услуг</p></div></div>',1)])],8,O))])])):l("",!0),(a(!0),d(T,null,V(o.modals,r=>(a(),d("div",{key:r.id,class:"bg-card rounded-lg border border-border p-6 space-y-6 shadow-sm"},[e("div",Q,[e("div",R,[e("h2",W,[t[7]||(t[7]=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})],-1)),w(" "+c(o.getModalTitle(r.type))+" ",1),e("span",{class:D(["ml-2 px-2 py-0.5 text-xs font-medium rounded",r.is_active?"bg-green-500/20 text-green-600":"bg-muted text-muted-foreground"])},c(r.is_active?"Активно":"Неактивно"),3)]),e("p",X,c(o.getModalDescription(r.type)),1)])]),e("div",Y,[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-foreground mb-2"}," Тип модального окна ",-1)),e("input",{value:r.type,type:"text",disabled:"",class:"w-full px-4 py-2.5 bg-muted border border-border rounded-lg text-muted-foreground cursor-not-allowed"},null,8,Z)]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-foreground mb-2"}," Заголовок модального окна ",-1)),b(e("input",{"onUpdate:modelValue":i=>r.title=i,type:"text",placeholder:"Информация",class:"w-full px-4 py-2.5 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent transition-all"},null,8,$),[[y,r.title]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-foreground mb-2"}," Текст информационного сообщения ",-1)),b(e("textarea",{"onUpdate:modelValue":i=>r.content=i,rows:"6",placeholder:"Введите текст информационного сообщения...",class:"w-full px-4 py-2.5 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent transition-all resize-y"},null,8,ee),[[y,r.content]])]),e("div",te,[b(e("input",{"onUpdate:modelValue":i=>r.is_active=i,type:"checkbox",id:`is_active_${r.id}`,class:"w-5 h-5 rounded border-border text-accent focus:ring-2 focus:ring-accent cursor-pointer"},null,8,oe),[[H,r.is_active]]),e("label",{for:`is_active_${r.id}`,class:"text-sm font-medium text-foreground cursor-pointer flex-1"}," Модальное окно активно ",8,se)])]),e("div",re,[e("button",{onClick:i=>o.saveModal(r),disabled:o.saving===r.id,class:"px-6 py-2.5 bg-accent text-accent-foreground rounded-lg hover:bg-accent/90 transition-all text-sm font-medium flex items-center gap-2 shadow-sm hover:shadow disabled:opacity-50 disabled:cursor-not-allowed"},[o.saving===r.id?(a(),d("svg",de,[...t[11]||(t[11]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):(a(),d("svg",ae,[...t[12]||(t[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])),w(" "+c(o.saving===r.id?"Сохранение...":"Сохранить"),1)],8,ne)])]))),128)),!o.modals||o.modals.length===0?(a(),d("div",ie,[...t[13]||(t[13]=[e("svg",{class:"w-12 h-12 text-muted-foreground mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})],-1),e("p",{class:"text-muted-foreground mb-4"},"Нет настроек модальных окон",-1)])])):l("",!0)]))])}const fe=B(N,[["render",le],["__scopeId","data-v-f6ae0cd1"]]);export{fe as default};
