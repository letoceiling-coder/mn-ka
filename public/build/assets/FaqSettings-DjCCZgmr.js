import{_ as z,c as i,b as e,d as b,t as f,f as v,l as w,v as q,x as _,q as U,a as A,w as L,T as N,h as x,i as H,j as O,J as j,o as d,F as D,k as R}from"./app-BED68XM5.js";import{S as h}from"./sweetalert2.esm.all-C0u8rGqG.js";const G={name:"FaqSettings",setup(){const k=x(!0),o=x(!1),g=x(null),t=x({}),c=x({}),s=x({title:"",is_active:!0,faq_items:[]}),u=async()=>{k.value=!0,g.value=null;try{const r=await j.get("/api/v1/faq-block-settings");r.data&&r.data.data&&(s.value={title:r.data.data.title||"",is_active:r.data.data.is_active!==!1,faq_items:Array.isArray(r.data.data.faq_items)?r.data.data.faq_items:[]})}catch(r){g.value=r.response?.data?.message||"Ошибка загрузки настроек",console.error("Error fetching settings:",r)}finally{k.value=!1}},n=()=>(t.value={},!s.value.title||s.value.title.trim().length===0?t.value.title="Заголовок обязателен для заполнения":s.value.title.length>255&&(t.value.title="Заголовок не должен превышать 255 символов"),Object.keys(t.value).length===0),m=r=>{if(!s.value.faq_items||!s.value.faq_items[r])return;const a=s.value.faq_items[r],l={};!a.question||a.question.trim().length===0?l.question="Вопрос обязателен для заполнения":a.question.length>255&&(l.question="Вопрос не должен превышать 255 символов"),(!a.answer||a.answer.trim().length===0)&&(l.answer="Ответ обязателен для заполнения"),Object.keys(l).length>0?c.value[r]=l:delete c.value[r]},y=()=>(c.value={},s.value.faq_items&&s.value.faq_items.length>0&&s.value.faq_items.forEach((r,a)=>{m(a)}),Object.keys(c.value).length===0),M=r=>c.value[r]||{},E=H(()=>{const r=n(),a=y(),l=s.value.faq_items&&s.value.faq_items.length>0;return r&&a&&l}),F=()=>{s.value.faq_items||(s.value.faq_items=[]),s.value.faq_items.push({question:"",answer:""})},V=async r=>{(await h.fire({title:"Удалить вопрос?",text:"Это действие нельзя отменить",icon:"warning",showCancelButton:!0,confirmButtonText:"Да, удалить",cancelButtonText:"Отмена",confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280"})).isConfirmed&&B(r)},B=r=>{if(s.value.faq_items&&s.value.faq_items.length>r){s.value.faq_items.splice(r,1),delete c.value[r];const a={};Object.keys(c.value).forEach(l=>{const p=parseInt(l);p>r?a[p-1]=c.value[l]:p<r&&(a[p]=c.value[l])}),c.value=a}},T=(r,a)=>{if(!s.value.faq_items||s.value.faq_items.length<=1)return;const l=a==="up"?r-1:r+1;if(l>=0&&l<s.value.faq_items.length){const p=s.value.faq_items[r];s.value.faq_items[r]=s.value.faq_items[l],s.value.faq_items[l]=p;const C=c.value[r],I=c.value[l];C?c.value[l]=C:delete c.value[l],I?c.value[r]=I:delete c.value[r]}},S=async()=>{if(!n()){await h.fire({title:"Ошибка валидации",text:"Пожалуйста, исправьте ошибки в форме",icon:"error",confirmButtonText:"ОК"});return}if(!y()){await h.fire({title:"Ошибка валидации",text:"Пожалуйста, заполните все поля вопросов и ответов",icon:"error",confirmButtonText:"ОК"});return}if(!s.value.faq_items||s.value.faq_items.length===0){await h.fire({title:"Нет вопросов",text:"Добавьте хотя бы один вопрос",icon:"warning",confirmButtonText:"ОК"});return}o.value=!0,g.value=null;try{const r=await j.put("/api/v1/faq-block-settings",s.value);await h.fire({title:"Настройки сохранены",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"})}catch(r){g.value=r.response?.data?.message||"Ошибка сохранения настроек";const a=r.response?.data?.errors;a&&a.title&&(t.value.title=a.title[0]),await h.fire({title:"Ошибка",text:g.value,icon:"error",confirmButtonText:"ОК"})}finally{o.value=!1}};return O(()=>{u()}),{loading:k,saving:o,error:g,errors:t,form:s,addFaqItem:F,confirmRemove:V,removeFaqItem:B,moveFaqItem:T,saveSettings:S,validateItem:m,getItemErrors:M,isFormValid:E}}},J={class:"faq-settings-page space-y-6"},Q={key:0,class:"flex items-center justify-center py-16"},K={key:1,class:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg"},P={class:"flex items-start gap-3"},W={class:"text-destructive"},X={key:2,class:"space-y-6"},Y={class:"bg-card rounded-lg border border-border p-6 space-y-6 shadow-sm"},Z={class:"space-y-4"},$={key:0,class:"mt-1 text-xs text-destructive"},ee={class:"flex items-center gap-3 p-4 bg-muted/30 rounded-lg"},te={class:"bg-card rounded-lg border border-border p-6 space-y-6 shadow-sm"},oe={class:"flex items-center justify-between flex-wrap gap-4"},re={class:"text-xl font-semibold text-foreground flex items-center gap-2"},se={key:0,class:"ml-2 px-2 py-0.5 text-xs font-medium bg-accent/20 text-accent rounded-full"},ne={key:0,class:"text-center py-12 border-2 border-dashed border-border rounded-lg"},ae={key:1,class:"space-y-4"},le={class:"flex items-center justify-between"},ie={class:"flex items-center gap-3"},de={class:"flex items-center justify-center w-8 h-8 rounded-full bg-accent/10 text-accent font-semibold text-sm"},ce={class:"font-semibold text-foreground"},ue={class:"flex items-center gap-2"},me=["onClick"],fe=["onUpdate:modelValue","onBlur"],ve={key:0,class:"mt-1 text-xs text-destructive"},ge={key:1,class:"mt-1 text-xs text-muted-foreground"},be=["onUpdate:modelValue","onBlur"],pe={key:0,class:"mt-1 text-xs text-destructive"},xe={key:1,class:"mt-1 text-xs text-muted-foreground"},he={class:"flex items-center gap-2 pt-2 border-t border-border"},_e=["onClick"],ke=["onClick"],we={class:"flex justify-end gap-3 pt-4 border-t border-border"},qe=["disabled"],ye={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Be={key:1,class:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"};function Ce(k,o,g,t,c,s){return d(),i("div",J,[o[19]||(o[19]=e("div",null,[e("h1",{class:"text-3xl font-semibold text-foreground"},"Настройки блока FAQ"),e("p",{class:"text-muted-foreground mt-1"},'Управление блоком "Часто задаваемые вопросы" на главной странице')],-1)),t.loading?(d(),i("div",Q,[...o[4]||(o[4]=[e("div",{class:"flex flex-col items-center gap-4"},[e("div",{class:"w-12 h-12 border-4 border-accent border-t-transparent rounded-full animate-spin"}),e("p",{class:"text-muted-foreground"},"Загрузка настроек...")],-1)])])):b("",!0),t.error?(d(),i("div",K,[e("div",P,[o[5]||(o[5]=e("svg",{class:"w-5 h-5 text-destructive flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("p",W,f(t.error),1)])])):b("",!0),t.loading?b("",!0):(d(),i("div",X,[e("div",Y,[o[8]||(o[8]=e("h2",{class:"text-xl font-semibold text-foreground flex items-center gap-2"},[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]),v(" Общие настройки ")],-1)),e("div",Z,[e("div",null,[o[6]||(o[6]=e("label",{class:"block text-sm font-medium text-foreground mb-2"}," Заголовок блока ",-1)),w(e("input",{"onUpdate:modelValue":o[0]||(o[0]=u=>t.form.title=u),type:"text",placeholder:"Часто задаваемые вопросы",class:_(["w-full px-4 py-2.5 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent transition-all",t.errors.title?"border-destructive":""])},null,2),[[q,t.form.title]]),t.errors.title?(d(),i("p",$,f(t.errors.title),1)):b("",!0)]),e("div",ee,[w(e("input",{"onUpdate:modelValue":o[1]||(o[1]=u=>t.form.is_active=u),type:"checkbox",id:"is_active",class:"w-5 h-5 rounded border-border text-accent focus:ring-2 focus:ring-accent cursor-pointer"},null,512),[[U,t.form.is_active]]),o[7]||(o[7]=e("label",{for:"is_active",class:"text-sm font-medium text-foreground cursor-pointer flex-1"}," Блок активен на главной странице ",-1)),e("span",{class:_(["px-2 py-1 text-xs font-medium rounded",t.form.is_active?"bg-green-500/20 text-green-600":"bg-muted text-muted-foreground"])},f(t.form.is_active?"Активен":"Неактивен"),3)])])]),e("div",te,[e("div",oe,[e("h2",re,[o[9]||(o[9]=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),o[10]||(o[10]=v(" Вопросы и ответы ",-1)),t.form.faq_items&&t.form.faq_items.length>0?(d(),i("span",se,f(t.form.faq_items.length),1)):b("",!0)]),e("button",{onClick:o[2]||(o[2]=(...u)=>t.addFaqItem&&t.addFaqItem(...u)),class:"px-4 py-2 bg-accent text-accent-foreground rounded-lg hover:bg-accent/90 transition-all text-sm font-medium flex items-center gap-2 shadow-sm hover:shadow"},[...o[11]||(o[11]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),v(" Добавить вопрос ",-1)])])]),t.form.faq_items&&t.form.faq_items.length===0?(d(),i("div",ne,[...o[12]||(o[12]=[e("svg",{class:"w-12 h-12 text-muted-foreground mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),e("p",{class:"text-muted-foreground mb-2"},"Нет вопросов",-1),e("p",{class:"text-sm text-muted-foreground"},"Добавьте первый вопрос, нажав кнопку выше",-1)])])):(d(),i("div",ae,[A(N,{name:"faq-item",tag:"div"},{default:L(()=>[(d(!0),i(D,null,R(t.form.faq_items,(u,n)=>(d(),i("div",{key:`faq-item-${n}`,class:_(["border border-border rounded-lg p-5 space-y-4 bg-background/50 hover:border-accent/50 transition-all",t.getItemErrors(n)?"border-destructive/50":""])},[e("div",le,[e("div",ie,[e("div",de,f(n+1),1),e("h3",ce,"Вопрос "+f(n+1),1)]),e("div",ue,[e("button",{onClick:m=>t.confirmRemove(n),class:"p-2 text-destructive hover:bg-destructive/10 rounded transition-colors",title:"Удалить вопрос"},[...o[13]||(o[13]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,me)])]),e("div",null,[o[14]||(o[14]=e("label",{class:"block text-sm font-medium text-foreground mb-2"},[v(" Вопрос "),e("span",{class:"text-destructive"},"*")],-1)),w(e("input",{"onUpdate:modelValue":m=>u.question=m,type:"text",placeholder:"Введите вопрос",class:_(["w-full px-4 py-2.5 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent transition-all",t.getItemErrors(n).question?"border-destructive":""]),onBlur:m=>t.validateItem(n)},null,42,fe),[[q,u.question]]),t.getItemErrors(n).question?(d(),i("p",ve,f(t.getItemErrors(n).question),1)):(d(),i("p",ge," Максимум 255 символов "))]),e("div",null,[o[15]||(o[15]=e("label",{class:"block text-sm font-medium text-foreground mb-2"},[v(" Ответ "),e("span",{class:"text-destructive"},"*")],-1)),w(e("textarea",{"onUpdate:modelValue":m=>u.answer=m,rows:"4",placeholder:"Введите ответ на вопрос. Поддерживается HTML разметка.",class:_(["w-full px-4 py-2.5 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent transition-all resize-y",t.getItemErrors(n).answer?"border-destructive":""]),onBlur:m=>t.validateItem(n)},null,42,be),[[q,u.answer]]),t.getItemErrors(n).answer?(d(),i("p",pe,f(t.getItemErrors(n).answer),1)):(d(),i("p",xe," Поддерживается HTML. Используйте <br> для переноса строки. "))]),e("div",he,[n>0?(d(),i("button",{key:0,onClick:m=>t.moveFaqItem(n,"up"),class:"px-3 py-1.5 text-sm border border-border hover:bg-accent/10 rounded transition-colors flex items-center gap-1",title:"Переместить вверх"},[...o[16]||(o[16]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 15l7-7 7 7"})],-1),v(" Вверх ",-1)])],8,_e)):b("",!0),n<t.form.faq_items.length-1?(d(),i("button",{key:1,onClick:m=>t.moveFaqItem(n,"down"),class:"px-3 py-1.5 text-sm border border-border hover:bg-accent/10 rounded transition-colors flex items-center gap-1",title:"Переместить вниз"},[...o[17]||(o[17]=[v(" Вниз ",-1),e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1)])],8,ke)):b("",!0)])],2))),128))]),_:1})]))]),e("div",we,[e("button",{onClick:o[3]||(o[3]=(...u)=>t.saveSettings&&t.saveSettings(...u)),disabled:t.saving||!t.isFormValid,class:"px-6 py-2.5 bg-accent text-accent-foreground rounded-lg hover:bg-accent/90 transition-all disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium flex items-center gap-2 shadow-sm hover:shadow"},[t.saving?(d(),i("div",Be)):(d(),i("svg",ye,[...o[18]||(o[18]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])),v(" "+f(t.saving?"Сохранение...":"Сохранить настройки"),1)],8,qe)])]))])}const Me=z(G,[["render",Ce],["__scopeId","data-v-20d54ba2"]]);export{Me as default};
