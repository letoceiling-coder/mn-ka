import{_ as f,c as n,b as s,t as p,p as v,q as x,l as b,v as y,h as d,j as _,J as g,o as a}from"./app-CNaojq3k.js";import{S as c}from"./sweetalert2.esm.all-C0u8rGqG.js";const k={name:"JSSettings",setup(){const i=d(!0),t=d(!1),l=d(null),e=d({custom_js_code:""}),u=async()=>{i.value=!0,l.value=null;try{const o=await g.get("/api/v1/seo-settings");o.data&&o.data.data&&(e.value.custom_js_code=o.data.data.custom_js_code||"")}catch(o){l.value=o.response?.data?.message||"Ошибка загрузки настроек",console.error("Error fetching JS settings:",o)}finally{i.value=!1}},m=async()=>{t.value=!0;try{await g.put("/api/v1/seo-settings",{custom_js_code:e.value.custom_js_code}),await c.fire({icon:"success",title:"Успешно!",text:"Настройки JavaScript кода успешно сохранены",timer:2e3,showConfirmButton:!1})}catch(o){await c.fire({icon:"error",title:"Ошибка!",text:o.response?.data?.message||"Не удалось сохранить настройки"})}finally{t.value=!1}},r=()=>{c.fire({title:"Очистить код?",text:"Вы уверены, что хотите удалить весь JavaScript код?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Да, очистить",cancelButtonText:"Отмена"}).then(o=>{o.isConfirmed&&(e.value.custom_js_code="")})};return _(()=>{u()}),{loading:i,saving:t,error:l,form:e,saveSettings:m,clearCode:r}}},h={class:"js-settings-page space-y-6"},w={key:0,class:"flex items-center justify-center py-12"},S={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4"},j={class:"text-sm text-red-600"},B={class:"bg-card rounded-lg border border-border p-6 space-y-4"},C={class:"flex justify-end gap-4"},J=["disabled"],E={key:0},T={key:1};function N(i,t,l,e,u,m){return a(),n("div",h,[t[9]||(t[9]=s("div",null,[s("h1",{class:"text-3xl font-semibold text-foreground"},"Настройки JavaScript кода"),s("p",{class:"text-muted-foreground mt-1"},"Добавление пользовательского JavaScript кода для всех публичных страниц")],-1)),e.loading?(a(),n("div",w,[...t[3]||(t[3]=[s("div",{class:"text-muted-foreground"},"Загрузка...",-1)])])):e.error?(a(),n("div",S,[s("p",j,p(e.error),1)])):(a(),n("form",{key:2,onSubmit:t[2]||(t[2]=v((...r)=>e.saveSettings&&e.saveSettings(...r),["prevent"])),class:"space-y-6"},[s("div",B,[t[7]||(t[7]=s("h2",{class:"text-xl font-semibold text-foreground"},"Пользовательский JavaScript код",-1)),s("div",null,[t[4]||(t[4]=s("label",{class:"block text-sm font-medium text-foreground mb-2"}," JavaScript код для вставки на все публичные страницы ",-1)),t[5]||(t[5]=s("p",{class:"text-xs text-muted-foreground mb-3"}," Вставьте код для Яндекс.Метрики, Google Analytics или других сервисов аналитики. Код будет добавлен в секцию <head> всех публичных страниц. ",-1)),b(s("textarea",{"onUpdate:modelValue":t[0]||(t[0]=r=>e.form.custom_js_code=r),rows:"15",placeholder:`<!-- Пример для Яндекс.Метрики -->\r
<script type="text/javascript">\r
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};\r
   m[i].l=1*new Date();\r
   for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}\r
   k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})\r
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");\r
\r
   ym(YOUR_COUNTER_ID, "init", {\r
        clickmap:true,\r
        trackLinks:true,\r
        accurateTrackBounce:true,\r
        webvisor:true\r
   });\r
<\/script>\r
<noscript><div><img src="https://mc.yandex.ru/watch/YOUR_COUNTER_ID" style="position:absolute; left:-9999px;" alt="" /></div></noscript>`,class:"w-full px-4 py-3 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-[#688E67] resize-none font-mono text-sm"},null,512),[[y,e.form.custom_js_code]]),t[6]||(t[6]=s("p",{class:"mt-2 text-xs text-muted-foreground"}," Код будет вставлен как есть, без дополнительной обработки. Убедитесь, что код корректный и не содержит синтаксических ошибок. ",-1))])]),t[8]||(t[8]=x('<div class="bg-blue-50 border border-blue-200 rounded-lg p-4"><div class="flex gap-3"><svg class="w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div><h3 class="text-sm font-semibold text-blue-900 mb-1">Важно</h3><ul class="text-xs text-blue-800 space-y-1"><li>• Код будет добавлен на все публичные страницы сайта</li><li>• Код вставляется в секцию &lt;head&gt; каждой страницы</li><li>• Для Яндекс.Метрики и Google Analytics обычно нужно вставить код отслеживания</li><li>• После сохранения изменения применяются ко всем новым загрузкам страниц</li></ul></div></div></div>',1)),s("div",C,[s("button",{type:"button",onClick:t[1]||(t[1]=(...r)=>e.clearCode&&e.clearCode(...r)),class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-medium"}," Очистить "),s("button",{type:"submit",disabled:e.saving,class:"px-6 py-3 bg-[#688E67] text-white rounded-lg hover:bg-[#5a7a5a] transition-colors disabled:opacity-50 font-medium"},[e.saving?(a(),n("span",E,"Сохранение...")):(a(),n("span",T,"Сохранить настройки"))],8,J)])],32))])}const U=f(k,[["render",N]]);export{U as default};
