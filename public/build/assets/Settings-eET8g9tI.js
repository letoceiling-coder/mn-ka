import{_ as y,c as n,b as t,d as f,t as g,l as m,E as _,F as w,k,q as z,h as d,j as h,o as l}from"./app-A-FoUqfi.js";import{a as b,b as q}from"./api-V9GPpd21.js";import{S as p}from"./sweetalert2.esm.all-C0u8rGqG.js";const S={name:"QuizSettings",setup(){const c=d(!1),e=d(!1),i=d(null),s=d([]),u=d({quiz_id:null,is_active:!0}),v=async()=>{try{const o=await b("/quizzes");if(o.ok){const a=await o.json();s.value=a.data||[]}}catch(o){console.error("Error fetching quizzes:",o)}},r=async()=>{c.value=!0,i.value=null;try{const o=await b("/quiz-block-settings");if(!o.ok)throw new Error("Ошибка загрузки настроек");const a=await o.json();a.data&&(u.value={quiz_id:a.data.quiz_id||null,is_active:a.data.is_active!==!1})}catch(o){i.value=o.message||"Ошибка загрузки настроек",console.error("Error fetching settings:",o)}finally{c.value=!1}},x=async()=>{e.value=!0,i.value=null;try{const o=await q("/quiz-block-settings",u.value);if(!o.ok){const a=await o.json().catch(()=>({}));throw new Error(a.message||"Ошибка сохранения настроек")}await p.fire({title:"Настройки сохранены",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"})}catch(o){i.value=o.message||"Ошибка сохранения настроек",await p.fire({title:"Ошибка",text:o.message||"Ошибка сохранения настроек",icon:"error",confirmButtonText:"ОК"})}finally{e.value=!1}};return h(async()=>{await Promise.all([v(),r()])}),{loading:c,saving:e,error:i,quizzes:s,form:u,saveSettings:x}}},j={class:"quiz-settings-page space-y-6"},E={key:0,class:"flex items-center justify-center py-12"},B={key:1,class:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg"},C={class:"text-destructive"},V={key:2,class:"bg-card rounded-lg border border-border p-6 space-y-6"},D={class:"space-y-4"},M=["value"],F={class:"flex items-center gap-2"},N={class:"flex justify-end gap-3 pt-4 border-t border-border"},P=["disabled"];function Q(c,e,i,s,u,v){return l(),n("div",j,[e[8]||(e[8]=t("div",{class:"flex items-center justify-between"},[t("div",null,[t("h1",{class:"text-3xl font-semibold text-foreground"},"Настройки блока квиза"),t("p",{class:"text-muted-foreground mt-1"},"Настройки блока квиза на главной странице")])],-1)),s.loading?(l(),n("div",E,[...e[3]||(e[3]=[t("p",{class:"text-muted-foreground"},"Загрузка настроек...",-1)])])):f("",!0),s.error?(l(),n("div",B,[t("p",C,g(s.error),1)])):f("",!0),s.loading?f("",!0):(l(),n("div",V,[t("div",D,[t("div",null,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Выберите квиз для отображения ",-1)),m(t("select",{"onUpdate:modelValue":e[0]||(e[0]=r=>s.form.quiz_id=r),class:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent"},[e[4]||(e[4]=t("option",{value:null},"-- Не выбран --",-1)),(l(!0),n(w,null,k(s.quizzes,r=>(l(),n("option",{key:r.id,value:r.id},g(r.title),9,M))),128))],512),[[_,s.form.quiz_id]]),e[6]||(e[6]=t("p",{class:"text-xs text-muted-foreground mt-1"}," Выберите квиз, который будет отображаться на главной странице ",-1))]),t("div",F,[m(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>s.form.is_active=r),type:"checkbox",id:"is_active",class:"w-4 h-4 rounded border-border"},null,512),[[z,s.form.is_active]]),e[7]||(e[7]=t("label",{for:"is_active",class:"text-sm font-medium text-foreground"}," Блок активен на главной странице ",-1))])]),t("div",N,[t("button",{onClick:e[2]||(e[2]=(...r)=>s.saveSettings&&s.saveSettings(...r)),disabled:s.saving,class:"px-6 py-2 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-lg transition-colors disabled:opacity-50"},g(s.saving?"Сохранение...":"Сохранить настройки"),9,P)])]))])}const T=y(S,[["render",Q]]);export{T as default};
