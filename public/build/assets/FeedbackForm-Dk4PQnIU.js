import{_ as C,h as f,y,i as E,c as a,b as o,d as m,t as c,p as F,l as h,f as k,v,A as _,a as S,r as V,o as i}from"./app-B_qSWCTG.js";import{S as T}from"./sweetalert2.esm.all-C0u8rGqG.js";import{C as N}from"./ConsentCheckbox-CGFciQA8.js";const U={name:"FeedbackForm",components:{ConsentCheckbox:N},props:{title:{type:String,default:"Обратная связь"},subtitle:{type:String,default:"Оставьте ваше сообщение, и мы обязательно свяжемся с вами"},hintText:{type:String,default:null}},setup(){const r=f({name:"",phone:"",email:"",message:""}),t=f({}),l=f(!1),e=f(!1),p=f(null),b=f(!1),g=f(!1),n=d=>{let s=d.replace(/\D/g,"");if(s.length>11&&(s=s.slice(0,11)),s.length>0&&!s.startsWith("7")&&(s.startsWith("8")?s="7"+s.slice(1):s="7"+s),s.length<=1)return s.length===0?"":"+7";let x="+7";const u=s.slice(1);return u.length>0&&(x+=" ("+u.slice(0,3),u.length>3&&(x+=") "+u.slice(3,6),u.length>6&&(x+="-"+u.slice(6,8),u.length>8&&(x+="-"+u.slice(8,10))))),x};y(()=>r.value.phone,d=>{r.value.phone=n(d)}),y(()=>r.value.message,d=>{d.length>5e3&&(r.value.message=d.slice(0,5e3))});const w=E(()=>r.value.name.trim()!==""&&r.value.message.trim()!==""&&b.value);return{form:r,errors:t,loading:l,success:e,error:p,canSubmit:w,consentGiven:b,consentError:g,submitForm:async()=>{if(!l.value){if(t.value={},p.value=null,g.value=!1,!b.value){g.value=!0;return}if(r.value.name.trim()===""||r.value.message.trim()===""){r.value.name.trim()===""&&(t.value.name="Поле обязательно для заполнения"),r.value.message.trim()===""&&(t.value.message="Поле обязательно для заполнения");return}l.value=!0;try{const d=await fetch("/api/public/feedback",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({name:r.value.name.trim(),phone:r.value.phone.trim()||null,email:r.value.email.trim()||null,message:r.value.message.trim()})}),s=await d.json();if(!d.ok)throw s.errors&&(t.value=s.errors),new Error(s.message||"Ошибка при отправке формы");e.value=!0,r.value={name:"",phone:"",email:"",message:""},b.value=!1,g.value=!1,await T.fire({icon:"success",title:"Спасибо!",text:"Ваше сообщение успешно отправлено. Мы свяжемся с вами в ближайшее время.",timer:3e3,showConfirmButton:!1}),setTimeout(()=>{e.value=!1},5e3)}catch(d){p.value=d.message||"Ошибка при отправке формы",console.error("Error submitting feedback:",d)}finally{l.value=!1}}}}}},j={class:"w-full px-3 sm:px-4 md:px-5 py-20 md:py-24 bg-background"},B={class:"w-full max-w-[1200px] mx-auto"},q={class:"feedback-form-container bg-[#F4F6FC] py-8 md:py-12 px-4 md:px-6 rounded-lg"},A={class:"max-w-4xl mx-auto"},D={key:0,class:"text-center mb-8"},G={key:0,class:"text-2xl md:text-3xl font-semibold text-foreground mb-3"},O={key:1,class:"text-muted-foreground text-base md:text-lg"},z={key:1,class:"text-center mb-4"},P={class:"text-sm text-muted-foreground"},W={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},I={key:0,class:"mt-1 text-sm text-red-500"},J={key:0,class:"mt-1 text-sm text-red-500"},K={key:0,class:"mt-1 text-sm text-red-500"},M={key:0,class:"mt-1 text-sm text-red-500"},R={class:"mt-1 text-xs text-muted-foreground"},X={class:"pt-2"},H={class:"flex justify-center pt-4"},L=["disabled"],Q={key:0},Y={key:1},Z={key:0,class:"p-4 bg-green-50 border border-green-200 rounded-lg text-green-800 text-center"},$={key:1,class:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-800 text-center"},ee={class:"font-medium"};function te(r,t,l,e,p,b){const g=V("ConsentCheckbox");return i(),a("section",j,[o("div",B,[o("div",q,[o("div",A,[l.title||l.subtitle?(i(),a("div",D,[l.title?(i(),a("h2",G,c(l.title),1)):m("",!0),l.subtitle?(i(),a("p",O,c(l.subtitle),1)):m("",!0)])):m("",!0),l.hintText?(i(),a("div",z,[o("p",P,c(l.hintText),1)])):m("",!0),o("form",{onSubmit:t[6]||(t[6]=F((...n)=>e.submitForm&&e.submitForm(...n),["prevent"])),class:"space-y-6"},[o("div",W,[o("div",null,[t[7]||(t[7]=o("label",{for:"name",class:"block text-sm font-medium text-foreground mb-2"},[k(" Имя "),o("span",{class:"text-red-500"},"*")],-1)),h(o("input",{id:"name","onUpdate:modelValue":t[0]||(t[0]=n=>e.form.name=n),type:"text",required:"",placeholder:"Ваше имя",class:_(["w-full h-12 px-4 border border-border rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#688E67] focus:border-transparent transition-colors",{"border-red-500":e.errors.name}])},null,2),[[v,e.form.name]]),e.errors.name?(i(),a("p",I,c(e.errors.name),1)):m("",!0)]),o("div",null,[t[8]||(t[8]=o("label",{for:"phone",class:"block text-sm font-medium text-foreground mb-2"}," Телефон ",-1)),h(o("input",{id:"phone","onUpdate:modelValue":t[1]||(t[1]=n=>e.form.phone=n),type:"tel",placeholder:"+7 (___) ___-__-__",class:_(["w-full h-12 px-4 border border-border rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#688E67] focus:border-transparent transition-colors",{"border-red-500":e.errors.phone}])},null,2),[[v,e.form.phone]]),e.errors.phone?(i(),a("p",J,c(e.errors.phone),1)):m("",!0)])]),o("div",null,[t[9]||(t[9]=o("label",{for:"email",class:"block text-sm font-medium text-foreground mb-2"}," Email ",-1)),h(o("input",{id:"email","onUpdate:modelValue":t[2]||(t[2]=n=>e.form.email=n),type:"email",placeholder:"your@email.com",class:_(["w-full h-12 px-4 border border-border rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#688E67] focus:border-transparent transition-colors",{"border-red-500":e.errors.email}])},null,2),[[v,e.form.email]]),e.errors.email?(i(),a("p",K,c(e.errors.email),1)):m("",!0)]),o("div",null,[t[10]||(t[10]=o("label",{for:"message",class:"block text-sm font-medium text-foreground mb-2"},[k(" Сообщение "),o("span",{class:"text-red-500"},"*")],-1)),h(o("textarea",{id:"message","onUpdate:modelValue":t[3]||(t[3]=n=>e.form.message=n),required:"",rows:"6",placeholder:"Введите ваше сообщение...",class:_(["w-full px-4 py-3 border border-border rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#688E67] focus:border-transparent resize-none transition-colors",{"border-red-500":e.errors.message}])},null,2),[[v,e.form.message]]),e.errors.message?(i(),a("p",M,c(e.errors.message),1)):m("",!0),o("p",R,c(e.form.message.length)+"/5000 символов ",1)]),o("div",X,[S(g,{modelValue:e.consentGiven,"onUpdate:modelValue":t[4]||(t[4]=n=>e.consentGiven=n),error:e.consentError,"onUpdate:error":t[5]||(t[5]=n=>e.consentError=n)},null,8,["modelValue","error"])]),o("div",H,[o("button",{type:"submit",disabled:e.loading||!e.canSubmit,class:"px-8 py-3 bg-[#688E67] text-white rounded-lg hover:bg-[#5a7a5a] transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium text-base min-w-[200px]"},[e.loading?(i(),a("span",Q,"Отправка...")):(i(),a("span",Y,"Отправить"))],8,L)]),e.success?(i(),a("div",Z,[...t[11]||(t[11]=[o("p",{class:"font-medium"},"Спасибо за ваше обращение!",-1),o("p",{class:"text-sm mt-1"},"Мы свяжемся с вами в ближайшее время.",-1)])])):m("",!0),e.error?(i(),a("div",$,[o("p",ee,c(e.error),1)])):m("",!0)],32)])])])])}const le=C(U,[["render",te],["__scopeId","data-v-70e93d22"]]);export{le as F};
