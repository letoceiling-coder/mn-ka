import{_ as C,h as f,y,i as E,c as a,b as t,d as m,t as u,p as F,l as v,f as k,v as h,A as _,a as S,r as V,o as i}from"./app-D6S8wRp1.js";import{S as N}from"./sweetalert2.esm.all-C0u8rGqG.js";import{C as T}from"./ConsentCheckbox-KHt5l7Oa.js";const U={name:"FeedbackForm",components:{ConsentCheckbox:T},props:{title:{type:String,default:"Обратная связь"},description:{type:String,default:"Оставьте ваше сообщение, и мы обязательно свяжемся с вами"}},setup(){const r=f({name:"",phone:"",email:"",message:""}),o=f({}),d=f(!1),e=f(!1),x=f(null),b=f(!1),g=f(!1),n=l=>{let s=l.replace(/\D/g,"");if(s.length>11&&(s=s.slice(0,11)),s.length>0&&!s.startsWith("7")&&(s.startsWith("8")?s="7"+s.slice(1):s="7"+s),s.length<=1)return s.length===0?"":"+7";let p="+7";const c=s.slice(1);return c.length>0&&(p+=" ("+c.slice(0,3),c.length>3&&(p+=") "+c.slice(3,6),c.length>6&&(p+="-"+c.slice(6,8),c.length>8&&(p+="-"+c.slice(8,10))))),p};y(()=>r.value.phone,l=>{r.value.phone=n(l)}),y(()=>r.value.message,l=>{l.length>5e3&&(r.value.message=l.slice(0,5e3))});const w=E(()=>r.value.name.trim()!==""&&r.value.message.trim()!==""&&b.value);return{form:r,errors:o,loading:d,success:e,error:x,canSubmit:w,consentGiven:b,consentError:g,submitForm:async()=>{if(!d.value){if(o.value={},x.value=null,g.value=!1,!b.value){g.value=!0;return}if(r.value.name.trim()===""||r.value.message.trim()===""){r.value.name.trim()===""&&(o.value.name="Поле обязательно для заполнения"),r.value.message.trim()===""&&(o.value.message="Поле обязательно для заполнения");return}d.value=!0;try{const l=await fetch("/api/public/feedback",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({name:r.value.name.trim(),phone:r.value.phone.trim()||null,email:r.value.email.trim()||null,message:r.value.message.trim()})}),s=await l.json();if(!l.ok)throw s.errors&&(o.value=s.errors),new Error(s.message||"Ошибка при отправке формы");e.value=!0,r.value={name:"",phone:"",email:"",message:""},b.value=!1,g.value=!1,await N.fire({icon:"success",title:"Спасибо!",text:"Ваше сообщение успешно отправлено. Мы свяжемся с вами в ближайшее время.",timer:3e3,showConfirmButton:!1}),setTimeout(()=>{e.value=!1},5e3)}catch(l){x.value=l.message||"Ошибка при отправке формы",console.error("Error submitting feedback:",l)}finally{d.value=!1}}}}}},j={class:"w-full px-3 sm:px-4 md:px-5 py-8 sm:py-12 md:py-16 lg:py-20 bg-background"},B={class:"w-full max-w-[1200px] mx-auto"},q={class:"feedback-form-container bg-[#F4F6FC] py-8 md:py-12 px-4 md:px-6 rounded-lg"},A={class:"max-w-4xl mx-auto"},D={key:0,class:"text-center mb-8"},G={key:0,class:"text-2xl md:text-3xl font-semibold text-foreground mb-3"},O={key:1,class:"text-muted-foreground text-base md:text-lg"},z={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},P={key:0,class:"mt-1 text-sm text-red-500"},W={key:0,class:"mt-1 text-sm text-red-500"},I={key:0,class:"mt-1 text-sm text-red-500"},J={key:0,class:"mt-1 text-sm text-red-500"},K={class:"mt-1 text-xs text-muted-foreground"},M={class:"pt-2"},R={class:"flex justify-center pt-4"},X=["disabled"],H={key:0},L={key:1},Q={key:0,class:"p-4 bg-green-50 border border-green-200 rounded-lg text-green-800 text-center"},Y={key:1,class:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-800 text-center"},Z={class:"font-medium"};function $(r,o,d,e,x,b){const g=V("ConsentCheckbox");return i(),a("section",j,[t("div",B,[t("div",q,[t("div",A,[d.title||d.description?(i(),a("div",D,[d.title?(i(),a("h2",G,u(d.title),1)):m("",!0),d.description?(i(),a("p",O,u(d.description),1)):m("",!0)])):m("",!0),t("form",{onSubmit:o[6]||(o[6]=F((...n)=>e.submitForm&&e.submitForm(...n),["prevent"])),class:"space-y-6"},[t("div",z,[t("div",null,[o[7]||(o[7]=t("label",{for:"name",class:"block text-sm font-medium text-foreground mb-2"},[k(" Имя "),t("span",{class:"text-red-500"},"*")],-1)),v(t("input",{id:"name","onUpdate:modelValue":o[0]||(o[0]=n=>e.form.name=n),type:"text",required:"",placeholder:"Ваше имя",class:_(["w-full h-12 px-4 border border-border rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#688E67] focus:border-transparent transition-colors",{"border-red-500":e.errors.name}])},null,2),[[h,e.form.name]]),e.errors.name?(i(),a("p",P,u(e.errors.name),1)):m("",!0)]),t("div",null,[o[8]||(o[8]=t("label",{for:"phone",class:"block text-sm font-medium text-foreground mb-2"}," Телефон ",-1)),v(t("input",{id:"phone","onUpdate:modelValue":o[1]||(o[1]=n=>e.form.phone=n),type:"tel",placeholder:"+7 (___) ___-__-__",class:_(["w-full h-12 px-4 border border-border rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#688E67] focus:border-transparent transition-colors",{"border-red-500":e.errors.phone}])},null,2),[[h,e.form.phone]]),e.errors.phone?(i(),a("p",W,u(e.errors.phone),1)):m("",!0)])]),t("div",null,[o[9]||(o[9]=t("label",{for:"email",class:"block text-sm font-medium text-foreground mb-2"}," Email ",-1)),v(t("input",{id:"email","onUpdate:modelValue":o[2]||(o[2]=n=>e.form.email=n),type:"email",placeholder:"your@email.com",class:_(["w-full h-12 px-4 border border-border rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#688E67] focus:border-transparent transition-colors",{"border-red-500":e.errors.email}])},null,2),[[h,e.form.email]]),e.errors.email?(i(),a("p",I,u(e.errors.email),1)):m("",!0)]),t("div",null,[o[10]||(o[10]=t("label",{for:"message",class:"block text-sm font-medium text-foreground mb-2"},[k(" Сообщение "),t("span",{class:"text-red-500"},"*")],-1)),v(t("textarea",{id:"message","onUpdate:modelValue":o[3]||(o[3]=n=>e.form.message=n),required:"",rows:"6",placeholder:"Введите ваше сообщение...",class:_(["w-full px-4 py-3 border border-border rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#688E67] focus:border-transparent resize-none transition-colors",{"border-red-500":e.errors.message}])},null,2),[[h,e.form.message]]),e.errors.message?(i(),a("p",J,u(e.errors.message),1)):m("",!0),t("p",K,u(e.form.message.length)+"/5000 символов ",1)]),t("div",M,[S(g,{modelValue:e.consentGiven,"onUpdate:modelValue":o[4]||(o[4]=n=>e.consentGiven=n),error:e.consentError,"onUpdate:error":o[5]||(o[5]=n=>e.consentError=n)},null,8,["modelValue","error"])]),t("div",R,[t("button",{type:"submit",disabled:e.loading||!e.canSubmit,class:"px-8 py-3 bg-[#688E67] text-white rounded-lg hover:bg-[#5a7a5a] transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium text-base min-w-[200px]"},[e.loading?(i(),a("span",H,"Отправка...")):(i(),a("span",L,"Отправить"))],8,X)]),e.success?(i(),a("div",Q,[...o[11]||(o[11]=[t("p",{class:"font-medium"},"Спасибо за ваше обращение!",-1),t("p",{class:"text-sm mt-1"},"Мы свяжемся с вами в ближайшее время.",-1)])])):m("",!0),e.error?(i(),a("div",Y,[t("p",Z,u(e.error),1)])):m("",!0)],32)])])])])}const se=C(U,[["render",$],["__scopeId","data-v-1ce7fad5"]]);export{se as F};
