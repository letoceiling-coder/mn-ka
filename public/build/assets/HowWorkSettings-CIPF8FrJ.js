import{_ as V,c as n,b as t,d as b,t as y,l as i,v as m,q as U,D as w,F as j,k as I,p as B,a as L,h as f,j as D,r as F,J as _,o as d}from"./app-C2upedQK.js";import{S as h}from"./sweetalert2.esm.all-C0u8rGqG.js";import H from"./Media-CvR0WCNR.js";import"./api-V9GPpd21.js";import"./index-Cuo_4o_7.js";/* empty css                        */const T={name:"HowWorkSettings",components:{Media:H},setup(){const g=f(!0),e=f(!1),c=f(null),o=f(!1),l=f({title:"",subtitle:null,image:null,image_alt:"",button_text:"",button_type:"url",button_value:"",is_active:!0,steps:[]}),k=async()=>{g.value=!0,c.value=null;try{const r=await _.get("/api/v1/how-work-block-settings");r.data&&r.data.data&&(l.value={title:r.data.data.title||"",subtitle:r.data.data.subtitle||null,image:r.data.data.image||null,image_alt:r.data.data.image_alt||"",button_text:r.data.data.button_text||"",button_type:r.data.data.button_type||"url",button_value:r.data.data.button_value||"",is_active:r.data.data.is_active!==!1,steps:r.data.data.steps||[]})}catch(r){c.value=r.response?.data?.message||"Ошибка загрузки настроек",console.error("Error fetching settings:",r)}finally{g.value=!1}},v=()=>{o.value=!0},s=r=>{if(r&&r.type==="photo"){const x=r.url.replace(/^\//,"");l.value.image=x,l.value.image_alt||(l.value.image_alt=r.original_name||"Как мы работаем"),o.value=!1}},u=()=>{l.value.steps||(l.value.steps=[]),l.value.steps.push({point:"disc",title:"",description:null})},a=r=>{l.value.steps&&l.value.steps.length>r&&l.value.steps.splice(r,1)},S=(r,x)=>{if(!l.value.steps||l.value.steps.length<=1)return;const p=x==="up"?r-1:r+1;if(p>=0&&p<l.value.steps.length){const C=l.value.steps[r];l.value.steps[r]=l.value.steps[p],l.value.steps[p]=C}},M=async()=>{e.value=!0,c.value=null;try{const r=await _.put("/api/v1/how-work-block-settings",l.value);await h.fire({title:"Настройки сохранены",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"})}catch(r){c.value=r.response?.data?.message||"Ошибка сохранения настроек",await h.fire({title:"Ошибка",text:c.value,icon:"error",confirmButtonText:"ОК"})}finally{e.value=!1}};return D(()=>{k()}),{loading:g,saving:e,error:c,form:l,showMediaModal:o,selectImage:v,handleImageSelected:s,addStep:u,removeStep:a,moveStep:S,saveSettings:M}}},W={class:"how-work-settings-page space-y-6"},z={key:0,class:"flex items-center justify-center py-12"},N={key:1,class:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg"},E={class:"text-destructive"},P={key:2,class:"space-y-6"},R={class:"bg-card rounded-lg border border-border p-6 space-y-6"},q={class:"space-y-4"},A={class:"flex items-center gap-2"},J={class:"bg-card rounded-lg border border-border p-6 space-y-6"},G={class:"space-y-4"},K={class:"space-y-3"},O={key:0,class:"relative"},Q=["src"],X={class:"mt-2 flex gap-2"},Y={key:1},Z={class:"bg-card rounded-lg border border-border p-6 space-y-6"},$={class:"space-y-4"},ee={key:0},te={key:1},oe={class:"bg-card rounded-lg border border-border p-6 space-y-6"},se={class:"flex items-center justify-between"},re={key:0,class:"text-center py-8 text-muted-foreground"},le={key:1,class:"space-y-4"},ne={class:"flex items-center justify-between"},de={class:"font-semibold text-foreground"},ae=["onClick"],ie={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ue=["onUpdate:modelValue"],be=["onUpdate:modelValue"],ce=["onUpdate:modelValue"],me={class:"flex gap-2"},fe=["onClick"],ge=["onClick"],pe={class:"flex justify-end gap-3 pt-4 border-t border-border"},ve=["disabled"],xe={class:"bg-background border border-border rounded-lg shadow-2xl w-full max-w-7xl max-h-[95vh] overflow-hidden flex flex-col my-auto"},ye={class:"p-4 border-b border-border flex items-center justify-between flex-shrink-0"},ke={class:"flex-1 overflow-auto h-full"};function we(g,e,c,o,l,k){const v=F("Media");return d(),n("div",W,[e[40]||(e[40]=t("div",null,[t("h1",{class:"text-3xl font-semibold text-foreground"},'Настройки блока "Как мы работаем"'),t("p",{class:"text-muted-foreground mt-1"},'Управление блоком "Как мы работаем" на главной странице')],-1)),o.loading?(d(),n("div",z,[...e[14]||(e[14]=[t("p",{class:"text-muted-foreground"},"Загрузка настроек...",-1)])])):b("",!0),o.error?(d(),n("div",N,[t("p",E,y(o.error),1)])):b("",!0),o.loading?b("",!0):(d(),n("div",P,[t("div",R,[e[17]||(e[17]=t("h2",{class:"text-xl font-semibold text-foreground"},"Общие настройки",-1)),t("div",q,[t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Заголовок блока ",-1)),i(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.form.title=s),type:"text",placeholder:"Как мы работаем",class:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent"},null,512),[[m,o.form.title]])]),t("div",A,[i(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.form.is_active=s),type:"checkbox",id:"is_active",class:"w-4 h-4 rounded border-border"},null,512),[[U,o.form.is_active]]),e[16]||(e[16]=t("label",{for:"is_active",class:"text-sm font-medium text-foreground"}," Блок активен на главной странице ",-1))])])]),t("div",J,[e[22]||(e[22]=t("h2",{class:"text-xl font-semibold text-foreground"},"Изображение",-1)),t("div",G,[t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Изображение ",-1)),t("div",K,[o.form.image?(d(),n("div",O,[t("img",{src:o.form.image.startsWith("data:")||o.form.image.startsWith("/")?o.form.image:`/${o.form.image}`,alt:"Preview",class:"w-full max-w-md h-auto object-cover rounded-lg border border-border"},null,8,Q),t("div",X,[t("button",{type:"button",onClick:e[2]||(e[2]=(...s)=>o.selectImage&&o.selectImage(...s)),class:"px-4 py-2 bg-accent/10 text-accent border border-accent/40 rounded hover:bg-accent/20"}," Изменить изображение "),t("button",{type:"button",onClick:e[3]||(e[3]=s=>{o.form.image=null,o.form.image_alt=""}),class:"px-4 py-2 bg-destructive/10 text-destructive border border-destructive/40 rounded hover:bg-destructive/20"}," Удалить ")])])):(d(),n("div",Y,[t("button",{type:"button",onClick:e[4]||(e[4]=(...s)=>o.selectImage&&o.selectImage(...s)),class:"w-full h-32 border-2 border-dashed border-border rounded flex items-center justify-center hover:bg-muted/10 transition-colors"},[...e[18]||(e[18]=[t("span",{class:"text-muted-foreground"},"Выберите изображение",-1)])])]))]),e[20]||(e[20]=t("p",{class:"text-xs text-muted-foreground mt-1"},"Рекомендуемый размер: 510x290px (десктоп), 290x165px (мобильный)",-1))]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Alt текст для изображения ",-1)),i(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>o.form.image_alt=s),type:"text",placeholder:"Как мы работаем",class:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent"},null,512),[[m,o.form.image_alt]])])])]),t("div",Z,[e[29]||(e[29]=t("h2",{class:"text-xl font-semibold text-foreground"},"Настройки кнопки",-1)),t("div",$,[t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Текст кнопки ",-1)),i(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.form.button_text=s),type:"text",placeholder:"Заказать обратный звонок",class:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent"},null,512),[[m,o.form.button_text]])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Тип кнопки ",-1)),i(t("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>o.form.button_type=s),class:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent"},[...e[24]||(e[24]=[t("option",{value:"url"},"URL (ссылка)",-1),t("option",{value:"method"},"Метод (popup)",-1)])],512),[[w,o.form.button_type]])]),o.form.button_type==="url"?(d(),n("div",ee,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," URL ",-1)),i(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>o.form.button_value=s),type:"text",placeholder:"/page или https://example.com",class:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent"},null,512),[[m,o.form.button_value]])])):b("",!0),o.form.button_type==="method"?(d(),n("div",te,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," ID метода ",-1)),i(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>o.form.button_value=s),type:"text",placeholder:"Методы будут добавлены позже",disabled:"",class:"w-full px-4 py-2 bg-background border border-border rounded-lg opacity-50 cursor-not-allowed"},null,512),[[m,o.form.button_value]]),e[28]||(e[28]=t("p",{class:"text-xs text-muted-foreground mt-1"},"Выбор методов будет доступен после создания функционала методов",-1))])):b("",!0)])]),t("div",oe,[t("div",se,[e[30]||(e[30]=t("h2",{class:"text-xl font-semibold text-foreground"},"Шаги работы",-1)),t("button",{onClick:e[10]||(e[10]=(...s)=>o.addStep&&o.addStep(...s)),class:"px-4 py-2 bg-accent text-accent-foreground rounded-lg hover:bg-accent/90 transition-colors text-sm font-medium"}," + Добавить шаг ")]),o.form.steps&&o.form.steps.length===0?(d(),n("div",re,[...e[31]||(e[31]=[t("p",null,"Нет шагов. Добавьте первый шаг.",-1)])])):(d(),n("div",le,[(d(!0),n(j,null,I(o.form.steps,(s,u)=>(d(),n("div",{key:u,class:"border border-border rounded-lg p-4 space-y-4"},[t("div",ne,[t("h3",de,"Шаг "+y(u+1),1),t("button",{onClick:a=>o.removeStep(u),class:"px-3 py-1 text-sm text-destructive hover:bg-destructive/10 rounded transition-colors"}," Удалить ",8,ae)]),t("div",ie,[t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Тип иконки ",-1)),i(t("select",{"onUpdate:modelValue":a=>s.point=a,class:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent"},[...e[32]||(e[32]=[t("option",{value:"disc"},"Круг",-1),t("option",{value:"star"},"Звезда",-1)])],8,ue),[[w,s.point]]),e[34]||(e[34]=t("p",{class:"text-xs text-muted-foreground mt-1"}," Круг для обычных шагов, звезда для финального шага ",-1))])]),t("div",null,[e[35]||(e[35]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Заголовок шага ",-1)),i(t("textarea",{"onUpdate:modelValue":a=>s.title=a,rows:"2",placeholder:"Вы оставляете заявку",class:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent resize-none"},null,8,be),[[m,s.title]]),e[36]||(e[36]=t("p",{class:"text-xs text-muted-foreground mt-1"}," Можно использовать HTML теги, например <br> для переноса строки ",-1))]),t("div",null,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Описание шага (необязательно) ",-1)),i(t("textarea",{"onUpdate:modelValue":a=>s.description=a,rows:"2",placeholder:"занимает не более 1-ой минуты",class:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent resize-none"},null,8,ce),[[m,s.description]]),e[38]||(e[38]=t("p",{class:"text-xs text-muted-foreground mt-1"}," Можно использовать HTML теги, например <br> для переноса строки ",-1))]),t("div",me,[u>0?(d(),n("button",{key:0,onClick:a=>o.moveStep(u,"up"),class:"px-3 py-1 text-sm border border-border hover:bg-accent/10 rounded transition-colors",title:"Переместить вверх"}," ↑ Вверх ",8,fe)):b("",!0),u<o.form.steps.length-1?(d(),n("button",{key:1,onClick:a=>o.moveStep(u,"down"),class:"px-3 py-1 text-sm border border-border hover:bg-accent/10 rounded transition-colors",title:"Переместить вниз"}," ↓ Вниз ",8,ge)):b("",!0)])]))),128))]))]),t("div",pe,[t("button",{onClick:e[11]||(e[11]=(...s)=>o.saveSettings&&o.saveSettings(...s)),disabled:o.saving,class:"px-6 py-2 bg-accent text-accent-foreground rounded-lg hover:bg-accent/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium"},y(o.saving?"Сохранение...":"Сохранить настройки"),9,ve)])])),o.showMediaModal?(d(),n("div",{key:3,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm overflow-y-auto p-4",onClick:e[13]||(e[13]=B(s=>o.showMediaModal=!1,["self"]))},[t("div",xe,[t("div",ye,[e[39]||(e[39]=t("h3",{class:"text-lg font-semibold"},"Выберите изображение",-1)),t("button",{onClick:e[12]||(e[12]=s=>o.showMediaModal=!1),class:"text-muted-foreground hover:text-foreground w-8 h-8 flex items-center justify-center rounded hover:bg-muted/10"}," ✕ ")]),t("div",ke,[L(v,{"selection-mode":!0,"count-file":1,onFileSelected:o.handleImageSelected},null,8,["onFileSelected"])])])])):b("",!0)])}const Ue=V(T,[["render",we],["__scopeId","data-v-29ecbe0f"]]);export{Ue as default};
