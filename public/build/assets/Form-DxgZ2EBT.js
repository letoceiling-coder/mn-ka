import{_ as g,c as w,b as o,t as b,p as y,l as c,v,q as h,a as k,w as _,h as u,C as S,j as B,r as E,E as V,o as C,f as j}from"./app-CUGfDZg2.js";import{a as M,b as T,c as D}from"./api-V9GPpd21.js";import{S as p}from"./sweetalert2.esm.all-C0u8rGqG.js";const N={name:"OptionForm",setup(){const n=S(),e=V(),a=u(!!n.params.id),t=u(!1),i=u(!1),d=u({name:"",order:0,is_active:!0}),m=async()=>{if(a.value){i.value=!0;try{const s=await M(`/options/${n.params.id}`);if(!s.ok)throw new Error("Ошибка загрузки опции");const l=await s.json();d.value={name:l.data.name||"",order:l.data.order||0,is_active:l.data.is_active??!0}}catch(s){await p.fire({title:"Ошибка",text:s.message||"Ошибка загрузки опции",icon:"error",confirmButtonText:"ОК"}),e.push({name:"admin.decisions.options"})}finally{i.value=!1}}},r=async()=>{t.value=!0;try{const s=a.value?`/options/${n.params.id}`:"/options",f=await(a.value?T:D)(s,d.value);if(!f.ok){const x=await f.json();throw new Error(x.message||"Ошибка сохранения опции")}await p.fire({title:"Успешно!",text:a.value?"Опция обновлена":"Опция создана",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"}),e.push({name:"admin.decisions.options"})}catch(s){await p.fire({title:"Ошибка",text:s.message||"Ошибка сохранения опции",icon:"error",confirmButtonText:"ОК"})}finally{t.value=!1}};return B(()=>{m()}),{isEdit:a,saving:t,loading:i,form:d,handleSubmit:r}}},U={class:"option-form-page space-y-6"},q={class:"text-3xl font-semibold text-foreground"},F={class:"bg-card rounded-lg border border-border p-6"},O={class:"flex items-center gap-3 cursor-pointer"},P={class:"flex items-center justify-end gap-4 pt-4 border-t border-border"},R=["disabled"];function G(n,e,a,t,i,d){const m=E("router-link");return C(),w("div",U,[o("div",null,[o("h1",q,b(t.isEdit?"Редактировать опцию":"Создать опцию"),1),e[4]||(e[4]=o("p",{class:"text-muted-foreground mt-1"},"Управление опцией",-1))]),o("div",F,[o("form",{onSubmit:e[3]||(e[3]=y((...r)=>t.handleSubmit&&t.handleSubmit(...r),["prevent"])),class:"space-y-6"},[o("div",null,[e[5]||(e[5]=o("label",{class:"block text-sm font-medium text-foreground mb-2"}," Название * ",-1)),c(o("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>t.form.name=r),type:"text",required:"",class:"w-full h-10 px-3 border border-border rounded bg-background text-sm",placeholder:"Введите название опции"},null,512),[[v,t.form.name]])]),o("div",null,[e[6]||(e[6]=o("label",{class:"block text-sm font-medium text-foreground mb-2"}," Порядок ",-1)),c(o("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>t.form.order=r),type:"number",min:"0",class:"w-full h-10 px-3 border border-border rounded bg-background text-sm",placeholder:"0"},null,512),[[v,t.form.order,void 0,{number:!0}]])]),o("div",null,[o("label",O,[c(o("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>t.form.is_active=r),type:"checkbox",class:"w-4 h-4 rounded border-border"},null,512),[[h,t.form.is_active]]),e[7]||(e[7]=o("span",{class:"text-sm font-medium text-foreground"},"Активна",-1))])]),o("div",P,[k(m,{to:{name:"admin.decisions.options"},class:"px-4 py-2 border border-border rounded hover:bg-muted/10 transition-colors"},{default:_(()=>[...e[8]||(e[8]=[j(" Отмена ",-1)])]),_:1}),o("button",{type:"submit",disabled:t.saving,class:"px-6 py-2 bg-accent text-accent-foreground rounded hover:bg-accent/90 disabled:opacity-50 disabled:cursor-not-allowed"},b(t.saving?"Сохранение...":"Сохранить"),9,R)])],32)])])}const I=g(N,[["render",G]]);export{I as default};
