import{_ as z,r as B,c as f,o as u,d as T,a as F,n as O,b as n,e as I,t as b,w as D,f as L,g as W,h as x,i as C,j as V,T as A,F as N,k as Q,u as U,l as M,v as H,m as K,p as R,q as J,s as G,x as X}from"./app-Do2upUsO.js";import{S as Y}from"./SEOHead-BX9ZReoe.js";import{u as Z}from"./usePreloader-CiHcCAv0.js";import{F as ee}from"./FeedbackModal-DSyBQJYs.js";import{W as te,F as se,H as ne}from"./WhyChooseUs-C0XKSJxt.js";import{D as oe}from"./DecisionCard-DTGbBduo.js";import{C as ae}from"./ConsentCheckbox-DUVmBswn.js";import{C as ie}from"./CaseCard-CO3Cb1od.js";import{F as re}from"./FeedbackForm-B0Mljq9x.js";import"./sweetalert2.esm.all-C0u8rGqG.js";const le={name:"HeroBanner",components:{FeedbackModal:ee},props:{slug:{type:String,default:"home-banner"},title:{type:String,default:null},subtitle:{type:String,default:null},buttonText:{type:String,default:null},buttonLink:{type:String,default:null}},setup(s){const t=x(null),i=x(!0),e=x(!1),c=C(()=>s?.title||t.value?.heading_1||t.value?.heading_2||null),o=C(()=>s?.subtitle||t.value?.description||null),r=C(()=>s?.buttonText||t.value?.button_text||null),m=C(()=>s?.buttonLink||(t.value?.button_type==="url"?t.value?.button_value:null)),_=async()=>{try{const y=await fetch(`/api/public/banners/${s.slug}`);if(y.ok){const v=await y.json();v.data&&(t.value={...v.data,background_image:v.data.background_image?`/${v.data.background_image.replace(/^\//,"")}`:null,height_desktop:v.data.height_desktop||380,height_mobile:v.data.height_mobile||300})}}catch(y){console.error("Error fetching banner:",y)}finally{i.value=!1}},q=()=>{t.value.button_type==="method"&&(!t.value.button_value||t.value.button_value.trim()===""?e.value=!0:console.log("Method button clicked:",t.value.button_value))},S=()=>{e.value=!1},j=C(()=>{if(!t.value)return{};const y=t.value.height_desktop||380,v=t.value.height_mobile||300,E=y-v,p=`(${v}px + ${E} * ((100vw - 320px) / 880))`;return{"--banner-height-mobile":`${v}px`,"--banner-height-desktop":`${y}px`,minHeight:`${v}px`,height:`clamp(${v}px, ${p}, ${y}px)`}});return V(()=>{_()}),{banner:t,loading:i,bannerStyle:j,showFeedbackModal:e,displayTitle:c,displaySubtitle:o,displayButtonText:r,displayButtonLink:m,handleButtonClick:q,handleFeedbackSuccess:S}}},ce={class:"w-full px-3 sm:px-4 md:px-5 py-8 sm:py-12 md:py-16 lg:py-20"},de={class:"w-full max-w-2xl"},ue={key:0,class:"space-y-2 sm:space-y-3 mb-6 sm:mb-8"},me={key:0,class:"text-white text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-semibold leading-tight drop-shadow-lg"},fe={key:1,class:"text-white text-lg sm:text-xl md:text-2xl lg:text-3xl font-normal leading-relaxed whitespace-pre-line drop-shadow-md"};function he(s,t,i,e,c,o){const r=B("FeedbackModal");return u(),f("div",ce,[e.banner&&e.banner.is_active?(u(),f("section",{key:0,class:"relative w-full max-w-[1200px] mx-auto rounded-lg overflow-hidden shadow-sm",style:O(e.bannerStyle)},[n("div",{class:"absolute inset-0 bg-cover bg-center bg-no-repeat bg-[#6C7B6D]",style:O({backgroundImage:e.banner.background_image?`url('${e.banner.background_image}')`:"none",backgroundSize:"cover",backgroundPosition:"center"})},null,4),n("div",{class:"relative z-10 w-full px-4 sm:px-6 lg:px-8 h-full flex items-center",style:O(e.bannerStyle)},[n("div",de,[e.displayTitle||e.displaySubtitle?(u(),f("div",ue,[e.displayTitle?(u(),f("h1",me,b(e.displayTitle),1)):T("",!0),e.displaySubtitle?(u(),f("p",fe,b(e.displaySubtitle),1)):T("",!0)])):T("",!0),e.displayButtonText?(u(),I(W(e.displayButtonLink?"a":"button"),{key:1,href:e.displayButtonLink||void 0,to:e.displayButtonLink&&!e.displayButtonLink.startsWith("http")?e.displayButtonLink:void 0,onClick:t[0]||(t[0]=m=>!e.displayButtonLink&&e.handleButtonClick),class:"inline-block px-8 py-3 bg-[#688E67] text-white rounded-lg hover:bg-[#5a7a5a] transition-colors font-medium text-base"},{default:D(()=>[L(b(e.displayButtonText),1)]),_:1},8,["href","to"])):T("",!0)])],4)],4)):T("",!0),F(r,{"is-open":e.showFeedbackModal,onClose:t[1]||(t[1]=m=>e.showFeedbackModal=!1),onSuccess:e.handleFeedbackSuccess},null,8,["is-open","onSuccess"])])}const pe=z(le,[["render",he]]),ge={name:"Decisions",components:{DecisionCard:oe,TransitionGroup:A},props:{title:{type:String,default:null},subtitle:{type:String,default:null}},setup(s){const t=U(),i=x("Выберите решение под ваш участок"),e=x(!0),c=x(null),o=C(()=>s?.title||i.value),r=C(()=>s?.subtitle||null),m=async()=>{try{const j=await fetch("/api/public/decision-block/settings");if(!j.ok)throw new Error("Ошибка загрузки настроек");const y=await j.json();y.data&&y.data.title&&(i.value=y.data.title)}catch(j){console.error("Ошибка загрузки настроек:",j)}},_=x([]),q=C(()=>_.value.slice(0,9)),S=async()=>{e.value=!0,c.value=null;try{const y=(await t.dispatch("fetchPublicProducts",{minimal:!1})||[]).map(a=>({...a,category:"products"})),E=(await t.dispatch("fetchPublicServices",{minimal:!0})||[]).map(a=>({...a,category:"services"}));_.value=[...y,...E]}catch(j){console.error("Ошибка загрузки данных:",j),c.value="Не удалось загрузить данные. Попробуйте обновить страницу."}finally{e.value=!1}};return V(async()=>{await Promise.all([m(),S()])}),{displayTitle:o,subtitle:r,allItems:_,displayedItems:q,loading:e,error:c}}},xe={class:"w-full px-3 sm:px-4 md:px-5 py-20 md:py-24"},_e={class:"w-full max-w-[1200px] mx-auto"},be={class:"flex justify-center mb-6 sm:mb-8"},ye={class:"text-2xl md:text-3xl font-semibold text-gray-900"},ve={key:0,class:"flex justify-center mb-6 sm:mb-8"},we={class:"text-base sm:text-lg text-gray-600 text-center max-w-3xl"},ke={key:1,class:"flex justify-center items-center py-12"},Ce={key:2,class:"flex justify-center items-center py-12"},Se={class:"text-red-500"},qe={key:0,class:"relative"},je={key:1,class:"flex justify-center items-center py-12"},Te={key:2,class:"flex justify-center mt-8 sm:mt-10"};function $e(s,t,i,e,c,o){const r=B("DecisionCard"),m=B("router-link");return u(),f("div",xe,[n("div",_e,[n("div",be,[n("h2",ye,b(e.displayTitle),1)]),e.subtitle?(u(),f("div",ve,[n("p",we,b(e.subtitle),1)])):T("",!0),e.loading?(u(),f("div",ke,[...t[0]||(t[0]=[n("div",{class:"text-gray-500"},"Загрузка...",-1)])])):e.error?(u(),f("div",Ce,[n("div",Se,b(e.error),1)])):(u(),f(N,{key:3},[e.displayedItems.length>0?(u(),f("div",qe,[F(A,{name:"stagger",tag:"div",class:"grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6"},{default:D(()=>[(u(!0),f(N,null,Q(e.displayedItems,(_,q)=>(u(),I(r,{key:`${_.id}-${_.category}`,decision:_,slug:_.category==="products"?"products":"services"},null,8,["decision","slug"]))),128))]),_:1})])):(u(),f("div",je,[...t[1]||(t[1]=[n("div",{class:"text-gray-500"},"Продукты и услуги не найдены",-1)])])),e.displayedItems.length>0?(u(),f("div",Te,[F(m,{to:"/services",class:"px-8 py-3 bg-[#688E67] text-white rounded-lg hover:bg-[#5a7a5a] transition-colors font-medium text-base inline-flex items-center justify-center"},{default:D(()=>[...t[2]||(t[2]=[L(" Услуги ",-1)])]),_:1})])):T("",!0)],64))])])}const ze=z(ge,[["render",$e],["__scopeId","data-v-297ff866"]]),Ee={name:"ImagesCollect",props:{data:{type:Object,required:!0},numberQuestion:{type:Number,required:!0}},emits:["next","answer"],methods:{handleSelect(s){const t={id:s.id||s.name,name:s.name||"",title:s.title||s.name||"",text:s.title||s.name||"",src:s.src||s.webp||""};this.$emit("answer",t),s.child?setTimeout(()=>{this.$emit("next",s.child)},300):setTimeout(()=>{this.$emit("next")},300)},handleImageError(s){s.target.src="/upload/quiz/placeholder.jpg"}}},Be={class:"mt-6"},Fe={class:"flex items-center gap-3 sm:gap-4 mb-6 px-2"},Ie={class:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-[#657C6C] text-white font-semibold text-lg sm:text-xl flex-shrink-0"},Ne={class:"question text-lg sm:text-xl md:text-2xl font-medium text-gray-900"},De={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4"},Ve=["onClick"],Qe={class:"relative aspect-[245/140] sm:aspect-[245/140] rounded-2xl overflow-hidden shadow-md hover:shadow-lg transition-all duration-300 transform hover:scale-105"},Me=["src","alt"],He={class:"absolute top-3 left-3 right-3 z-10"},Le={class:"text-white font-medium text-base sm:text-lg md:text-xl drop-shadow-lg"};function Pe(s,t,i,e,c,o){return u(),f("div",Be,[n("div",Fe,[n("div",Ie,b(i.data.id),1),n("div",Ne,b(i.data.question),1)]),n("div",De,[(u(!0),f(N,null,Q(i.data.selects,r=>(u(),f("div",{key:r.id,class:"relative group cursor-pointer",onClick:m=>o.handleSelect(r)},[n("div",Qe,[n("img",{src:r.src||r.webp||"/upload/quiz/placeholder.jpg",alt:r.name||r.title,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",onError:t[0]||(t[0]=(...m)=>o.handleImageError&&o.handleImageError(...m))},null,40,Me),t[1]||(t[1]=n("div",{class:"absolute inset-0 bg-gradient-to-b from-black/60 via-black/20 to-transparent pointer-events-none"},null,-1)),n("div",He,[n("h3",Le,b(r.title),1)])])],8,Ve))),128))])])}const Oe=z(Ee,[["render",Pe]]),We={name:"Selects",props:{data:{type:Object,required:!0},numberQuestion:{type:Number,required:!0}},emits:["next","answer"],methods:{handleSelect(s){const t={id:s.id||s.name,name:s.name||"",title:s.title||s.name||"",text:s.name||s.title||""};this.$emit("answer",t),setTimeout(()=>{this.$emit("next")},300)}}},Ae={class:"mt-6"},Ue={class:"flex items-center gap-3 sm:gap-4 mb-6 px-2"},Ke={class:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-[#657C6C] text-white font-semibold text-lg sm:text-xl flex-shrink-0"},Re={class:"question text-lg sm:text-xl md:text-2xl font-medium text-gray-900"},Je={class:"space-y-3 sm:space-y-4 max-w-2xl"},Ge=["onClick"];function Xe(s,t,i,e,c,o){return u(),f("div",Ae,[n("div",Ue,[n("div",Ke,b(i.data.id),1),n("div",Re,b(i.data.question),1)]),n("div",Je,[(u(!0),f(N,null,Q(i.data.selects,r=>(u(),f("button",{key:r.id,onClick:m=>o.handleSelect(r),class:"w-full px-6 py-4 text-left bg-white border-2 border-gray-200 rounded-lg hover:border-[#657C6C] hover:bg-gray-50 transition-all duration-200 text-base sm:text-lg font-normal text-gray-900 focus:outline-none focus:ring-2 focus:ring-[#657C6C] focus:ring-offset-2"},b(r.name),9,Ge))),128))])])}const Ye=z(We,[["render",Xe]]),Ze={name:"Inputs",props:{data:{type:Object,required:!0},numberQuestion:{type:Number,required:!0}},emits:["next","answer"],setup(s,{emit:t}){const i=x(s.data?.answer||""),e=C(()=>{const o=i.value;return o==null?!1:o.toString().trim()!==""});return{answerValue:i,isAnswerValid:e,handleNext:()=>{const o=i.value?.toString().trim()||"";o&&(s.data&&(s.data.answer=o),t("answer",o),s.data?.child?t("next",s.data.child):t("next"))}}}},et={class:"mt-6"},tt={class:"flex items-center gap-3 sm:gap-4 mb-6 px-2"},st={class:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-[#657C6C] text-white font-semibold text-lg sm:text-xl flex-shrink-0"},nt={class:"question text-lg sm:text-xl md:text-2xl font-medium text-gray-900"},ot={class:"max-w-2xl"},at={class:"block text-sm font-medium text-gray-700 mb-2"},it={class:"flex flex-col sm:flex-row gap-3 sm:gap-4"},rt=["placeholder"],lt=["disabled"];function ct(s,t,i,e,c,o){return u(),f("div",et,[n("div",tt,[n("div",st,b(i.data.id),1),n("div",nt,b(i.data.question),1)]),n("div",ot,[n("label",at,b(i.data.label),1),n("div",it,[M(n("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>e.answerValue=r),type:"text",placeholder:i.data.placeholder,onKeyup:t[1]||(t[1]=K((...r)=>e.handleNext&&e.handleNext(...r),["enter"])),class:"flex-1 w-full rounded-md border border-gray-300 bg-white px-4 py-3 text-sm sm:text-base transition-colors disabled:opacity-50 focus:border-[#657C6C] focus:ring-2 focus:ring-[#657C6C]/20 focus:outline-none"},null,40,rt),[[H,e.answerValue]]),n("button",{onClick:t[2]||(t[2]=(...r)=>e.handleNext&&e.handleNext(...r)),disabled:!e.isAnswerValid,class:"px-6 sm:px-8 py-3 bg-[#657C6C] hover:bg-[#55695a] disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[#657C6C] focus:ring-offset-2"}," Далее ",8,lt)])])])}const dt=z(Ze,[["render",ct]]),ut={name:"Forms",components:{ConsentCheckbox:ae},props:{data:{type:Object,required:!0},numberQuestion:{type:Number,required:!0}},emits:["next","answer"],data(){return{consentError:!1}},computed:{isFormValid(){return this.data.form.name&&this.data.form.name.trim()!==""&&this.data.form.email&&this.data.form.email.trim()!==""&&this.data.form.phone&&this.data.form.phone.trim()!==""&&this.data.form.check}},methods:{async handleSubmit(){if(!this.data.form.check){this.consentError=!0;return}this.consentError=!1,this.isFormValid&&(this.$emit("answer",this.data.form),this.$emit("submit",{name:this.data.form.name,email:this.data.form.email,phone:this.data.form.phone}))}}},mt={class:"mt-6"},ft={class:"mb-6 px-2"},ht=["innerHTML"],pt={class:"max-w-2xl"},gt={class:"pt-2"},xt=["disabled"];function _t(s,t,i,e,c,o){const r=B("ConsentCheckbox");return u(),f("div",mt,[n("div",ft,[n("div",{class:"question text-lg sm:text-xl md:text-2xl font-medium text-gray-900",innerHTML:i.data.question},null,8,ht)]),n("div",pt,[n("form",{onSubmit:t[5]||(t[5]=R((...m)=>o.handleSubmit&&o.handleSubmit(...m),["prevent"])),class:"space-y-4"},[n("div",null,[t[6]||(t[6]=n("label",{for:"quiz-name",class:"block text-sm font-medium text-gray-700 mb-2"}," Ваше имя ",-1)),M(n("input",{id:"quiz-name","onUpdate:modelValue":t[0]||(t[0]=m=>i.data.form.name=m),type:"text",required:"",class:"w-full rounded-md border border-gray-300 bg-white px-4 py-3 text-sm sm:text-base transition-colors focus:border-[#657C6C] focus:ring-2 focus:ring-[#657C6C]/20 focus:outline-none",placeholder:"Иван Иванов"},null,512),[[H,i.data.form.name]])]),n("div",null,[t[7]||(t[7]=n("label",{for:"quiz-email",class:"block text-sm font-medium text-gray-700 mb-2"}," Ваш email ",-1)),M(n("input",{id:"quiz-email","onUpdate:modelValue":t[1]||(t[1]=m=>i.data.form.email=m),type:"email",required:"",class:"w-full rounded-md border border-gray-300 bg-white px-4 py-3 text-sm sm:text-base transition-colors focus:border-[#657C6C] focus:ring-2 focus:ring-[#657C6C]/20 focus:outline-none",placeholder:"your@email.com"},null,512),[[H,i.data.form.email]])]),n("div",null,[t[8]||(t[8]=n("label",{for:"quiz-phone",class:"block text-sm font-medium text-gray-700 mb-2"}," Ваш телефон ",-1)),M(n("input",{id:"quiz-phone","onUpdate:modelValue":t[2]||(t[2]=m=>i.data.form.phone=m),type:"tel",required:"",class:"w-full rounded-md border border-gray-300 bg-white px-4 py-3 text-sm sm:text-base transition-colors focus:border-[#657C6C] focus:ring-2 focus:ring-[#657C6C]/20 focus:outline-none",placeholder:"+7 (999) 123-45-67"},null,512),[[H,i.data.form.phone]])]),n("div",gt,[F(r,{modelValue:i.data.form.check,"onUpdate:modelValue":t[3]||(t[3]=m=>i.data.form.check=m),error:c.consentError,"onUpdate:error":t[4]||(t[4]=m=>c.consentError=m),"input-id":"quiz-consent-checkbox"},null,8,["modelValue","error"])]),n("button",{type:"submit",disabled:!o.isFormValid,class:"w-full sm:w-auto px-8 py-3 bg-[#657C6C] hover:bg-[#55695a] disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[#657C6C] focus:ring-offset-2"}," Отправить ",8,xt)],32)])])}const bt=z(ut,[["render",_t]]),yt={name:"Thank",props:{data:{type:Object,default:()=>({})},numberQuestion:{type:Number,required:!0}}},vt={class:"mt-6"};function wt(s,t,i,e,c,o){return u(),f("div",vt,[...t[0]||(t[0]=[J('<div class="flex flex-col items-center justify-center py-8 sm:py-12 px-4"><div class="w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-green-100 flex items-center justify-center mb-6"><svg class="w-8 h-8 sm:w-10 sm:h-10 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div><h3 class="text-xl sm:text-2xl md:text-3xl font-semibold text-gray-900 text-center mb-4"> Спасибо! </h3><p class="text-base sm:text-lg text-gray-600 text-center max-w-md"> Наши специалисты свяжутся с вами в течение 15 минут </p></div>',1)])])}const kt=z(yt,[["render",wt]]),Ct={name:"Quiz",components:{"images-collect":Oe,selects:Ye,inputs:dt,forms:bt,thank:kt},props:{title:{type:String,default:"Подберите идеальное решение"},description:{type:String,default:"Ответьте на несколько вопросов, и мы предложим оптимальный вариант"}},setup(){const s=x(!0),t=x(null),i=x(null),e=x([]),c=x(1),o=x([]),r=x(!1),m=x({}),_=x(!1),q=x(!1),S=async()=>{try{const l=await fetch("/api/public/quiz-block/settings");if(!l.ok)throw new Error("Ошибка загрузки настроек");const d=await l.json();d.data?(r.value=d.data.is_active===!0,d.data.quiz_id?await j(d.data.quiz_id):s.value=!1):s.value=!1}catch(l){console.error("Ошибка загрузки настроек блока квиза:",l),s.value=!1}},j=async l=>{s.value=!0,t.value=null;try{const d=await fetch(`/api/public/quiz-block/quiz/${l}`);if(!d.ok)throw new Error("Ошибка загрузки квиза");const h=await d.json();h.data&&(i.value={id:h.data.id,title:h.data.title,description:h.data.description},e.value=(h.data.questions||[]).filter(w=>w.is_active!==!1).sort((w,k)=>(w.order||0)-(k.order||0)).map((w,k)=>({...w,displayId:k+1})),e.value.length>0&&(c.value=e.value[0].displayId,o.value=[]))}catch(d){t.value=d.message||"Ошибка загрузки квиза",console.error("Ошибка загрузки квиза:",d)}finally{s.value=!1}},y=l=>{const d={id:l.displayId||l.id||l.order,question:l.question_text||"",type:l.question_type,...l.question_data||{}};return(l.question_type==="images-collect"||l.question_type==="selects")&&l.question_data?.selects&&(d.selects=l.question_data.selects.map((h,w)=>({id:h.id||w+1,name:h.name||"",src:h.src||"",title:h.title||h.name||"",child:h.child||null}))),l.question_type==="inputs"&&l.question_data&&(d.label=l.question_data.label||"",d.placeholder=l.question_data.placeholder||"",d.child=l.question_data.child||null,d.answer=""),l.question_type==="forms"&&l.question_data&&(d.form=l.question_data.form||{name:"",email:"",phone:"",check:!1},d.child=l.question_data.child||null,d.question=l.question_text||l.question_data.question||""),d},v=C(()=>e.value.find(l=>l.displayId===c.value)),E=l=>{const d=c.value;if(d&&!o.value.includes(d)&&o.value.push(d),l){const h=e.value.findIndex(w=>w.displayId===c.value);l>0&&l<=e.value.length?c.value=l:h<e.value.length-1&&(c.value=e.value[h+1].displayId)}else{const h=e.value.findIndex(w=>w.displayId===c.value);h<e.value.length-1&&(c.value=e.value[h+1].displayId)}},a=()=>{const l=e.value.findIndex(d=>d.displayId===c.value);if(l>0){const d=e.value[l-1];if(d){const h=o.value.lastIndexOf(c.value);h!==-1&&(o.value=o.value.slice(0,h)),c.value=d.displayId}}},p=l=>{const d=e.value.find(h=>h.displayId===c.value);d&&(m.value[d.id]={question_id:d.id,question_text:d.question_text,question_type:d.question_type,answer:l})},g=async l=>{if(!(q.value||_.value)){q.value=!0;try{const d=e.value.filter($=>m.value[$.id]).map($=>m.value[$.id].answer),h=await fetch("/api/public/quiz/submit",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({quiz_id:i.value.id,answers:d,contact:l})});let w="",k=null;try{if(w=await h.text(),w)try{k=JSON.parse(w)}catch($){throw console.error("Ошибка парсинга JSON:",$,"Response text:",w.substring(0,200)),new Error("Сервер вернул некорректный ответ. Пожалуйста, попробуйте еще раз.")}}catch($){throw console.error("Ошибка чтения ответа:",$),new Error("Ошибка получения ответа от сервера")}if(!h.ok){const $=k&&k.message||k&&k.error||`Ошибка сервера: ${h.status} ${h.statusText}`;throw new Error($)}if(!k)throw console.error("Сервер вернул пустой ответ. Response text:",w.substring(0,200)),new Error("Сервер вернул пустой ответ");if(typeof k!="object")throw console.error("Сервер вернул некорректный тип данных:",typeof k,k),new Error("Сервер вернул некорректный ответ");if(k.success===!0)return _.value=!0,{success:!0,message:k.message||"Спасибо за прохождение квиза!"};{const $=k.message||k.error||"Ошибка отправки результатов квиза";throw new Error($)}}catch(d){return console.error("Ошибка отправки результатов квиза:",d),{success:!1,message:d.message||"Ошибка отправки результатов квиза. Пожалуйста, попробуйте еще раз."}}finally{q.value=!1}}},P=async l=>{const d=await g(l);d.success?E():alert(d.message||"Произошла ошибка при отправке результатов. Пожалуйста, попробуйте еще раз.")};return V(()=>{S()}),{loading:s,error:t,quizData:i,questions:e,currentQuestionNumber:c,currentQuestion:v,isActive:r,isCompleted:_,isSubmitting:q,formatQuestionData:y,goToNext:E,goToPrevious:a,handleAnswer:p,handleSubmit:P,submitQuiz:g,questionHistory:o}}},St={key:0,class:"w-full px-3 sm:px-4 md:px-5 py-8 sm:py-12 md:py-16 lg:py-20"},qt={class:"w-full max-w-[1200px] mx-auto"},jt={class:"flex flex-col items-center mb-6 sm:mb-8"},Tt={class:"text-2xl sm:text-3xl md:text-4xl font-semibold text-gray-900 text-center mb-3"},$t={key:0,class:"text-gray-600 text-center text-base sm:text-lg"},zt={key:0,class:"flex justify-center items-center py-12"},Et={key:1,class:"flex justify-center items-center py-12"},Bt={class:"text-red-500"},Ft={key:0,class:"mb-4"};function It(s,t,i,e,c,o){return e.isActive?(u(),f("div",St,[n("div",qt,[n("div",jt,[n("h2",Tt,b(e.quizData?.title||i.title),1),e.quizData?.description||i.description?(u(),f("p",$t,b(e.quizData?.description||i.description),1)):T("",!0)]),e.loading?(u(),f("div",zt,[...t[1]||(t[1]=[n("div",{class:"text-gray-500"},"Загрузка квиза...",-1)])])):e.error?(u(),f("div",Et,[n("div",Bt,b(e.error),1)])):e.currentQuestion?(u(),I(G,{key:2,name:"quiz-fade",mode:"out-in"},{default:D(()=>[n("div",null,[e.questionHistory.length>0||e.currentQuestionNumber>1?(u(),f("div",Ft,[n("button",{onClick:t[0]||(t[0]=(...r)=>e.goToPrevious&&e.goToPrevious(...r)),class:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors text-sm sm:text-base"},[...t[2]||(t[2]=[n("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),L(" Назад ",-1)])])])):T("",!0),(u(),I(W(e.currentQuestion.question_type),{key:e.currentQuestion.id,data:e.formatQuestionData(e.currentQuestion),"number-question":e.currentQuestion.id,onNext:e.goToNext,onAnswer:e.handleAnswer,onSubmit:e.handleSubmit},null,40,["data","number-question","onNext","onAnswer","onSubmit"]))])]),_:1})):T("",!0)])])):T("",!0)}const Nt=z(Ct,[["render",It],["__scopeId","data-v-1bcb4acb"]]),Dt={name:"CasesBlock",components:{CaseCard:ie},setup(){const s=x(null),t=x([]),i=x(!0),e=async()=>{try{const o=await fetch("/api/public/cases-block/settings");if(o.ok){const r=await o.json();r.data&&(s.value=r.data,s.value.case_ids&&s.value.case_ids.length>0&&await c(s.value.case_ids))}}catch(o){console.error("Error fetching Cases block settings:",o)}finally{i.value=!1}},c=async o=>{try{const r=o.join(","),m=await fetch(`/api/public/cases?ids=${r}&with=image,images`);if(m.ok){const _=await m.json();if(_.data){const q=new Map(_.data.map(S=>[S.id,S]));t.value=o.map(S=>q.get(S)).filter(S=>S!==void 0)}}}catch(r){console.error("Error fetching cases:",r)}};return V(()=>{e()}),{settings:s,cases:t,loading:i}}},Vt={key:0,class:"w-full px-3 sm:px-4 md:px-5 py-20 md:py-24 bg-background"},Qt={class:"w-full max-w-[1200px] mx-auto"},Mt={key:0,class:"flex justify-center mb-6 md:mb-8"},Ht={class:"text-2xl sm:text-3xl md:text-4xl font-semibold text-foreground text-center"},Lt={class:"grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8"},Pt={class:"flex justify-center mt-8 md:mt-12"};function Ot(s,t,i,e,c,o){const r=B("CaseCard"),m=B("router-link");return e.settings&&e.settings.is_active&&e.cases.length>0?(u(),f("section",Vt,[n("div",Qt,[e.settings.title?(u(),f("div",Mt,[n("h2",Ht,b(e.settings.title),1)])):T("",!0),n("div",Lt,[(u(!0),f(N,null,Q(e.cases,_=>(u(),I(r,{key:_.id,"case-item":_},null,8,["case-item"]))),128))]),n("div",Pt,[F(m,{to:"/cases",class:"inline-flex items-center justify-center px-8 py-3 bg-[#688E67] text-white rounded-lg hover:bg-[#5a7a5a] transition-colors font-medium text-base"},{default:D(()=>[...t[0]||(t[0]=[L(" Смотреть все кейсы ",-1)])]),_:1})])])])):T("",!0)}const Wt=z(Dt,[["render",Ot]]),At={HeroBanner:pe,HowWork:ne,Decisions:ze,Quiz:Nt,Faq:se,WhyChooseUs:te,CasesBlock:Wt,FeedbackForm:re},Ut={name:"Home",components:{SEOHead:Y},setup(){const{hidePreloader:s}=Z(),t=x([]),i=x(!0),e=x(null),c={site_name:"МНКА - Профессиональные услуги по работе с земельными участками",site_description:"Профессиональные услуги по подбору и оформлению земельных участков. Кадастровые работы, консультации, оформление документов.",site_keywords:"земельные участки, кадастр, оформление документов, недвижимость, МНКА",default_og_image:"",og_type:"website"},o=x(c),r=C(()=>t.value.map(a=>{const p=At[a.component];if(!p)return console.warn(`Component ${a.component} not found`),null;const g={...a.settings||{}};return e.value&&(a.component==="HeroBanner"?(e.value.hero_title&&(g.title=e.value.hero_title),e.value.hero_subtitle&&(g.subtitle=e.value.hero_subtitle),e.value.hero_button_text&&(g.buttonText=e.value.hero_button_text),e.value.hero_button_link&&(g.buttonLink=e.value.hero_button_link)):a.component==="Decisions"?(e.value.select_title&&(g.title=e.value.select_title),e.value.select_subtitle&&(g.subtitle=e.value.select_subtitle)):a.component==="HowWork"?(e.value.work_title&&(g.title=e.value.work_title),e.value.work_items&&(g.items=e.value.work_items),e.value.work_button_text&&(g.buttonText=e.value.work_button_text),e.value.work_button_link&&(g.buttonLink=e.value.work_button_link)):a.component==="Faq"?(e.value.faq_title&&(g.title=e.value.faq_title),e.value.faq_items&&(g.items=e.value.faq_items)):a.component==="WhyChooseUs"?(e.value.benefits_title&&(g.title=e.value.benefits_title),e.value.benefits_items&&(g.items=e.value.benefits_items)):a.component==="FeedbackForm"&&(e.value.contact_title&&(g.title=e.value.contact_title),e.value.contact_subtitle&&(g.subtitle=e.value.contact_subtitle),e.value.contact_form_hint_text&&(g.hintText=e.value.contact_form_hint_text))),{key:a.key,component:p,props:g}}).filter(a=>a!==null)),m=async()=>{try{const a=await fetch("/api/public/home-page-blocks");if(a.ok){const p=await a.json();p.data&&(t.value=p.data)}}catch(a){console.error("Error fetching home page blocks:",a),t.value=[{key:"hero_banner",component:"HeroBanner",settings:{}},{key:"decisions",component:"Decisions",settings:{}},{key:"quiz",component:"Quiz",settings:{}},{key:"how_work",component:"HowWork",settings:{}},{key:"faq",component:"Faq",settings:{}},{key:"why_choose_us",component:"WhyChooseUs",settings:{}},{key:"cases_block",component:"CasesBlock",settings:{}},{key:"feedback_form",component:"FeedbackForm",settings:{title:"Остались вопросы?",description:"Напишите нам, и мы с удовольствием ответим на все ваши вопросы"}}]}finally{i.value=!1,s()}},_=C(()=>window.location.origin+"/"),q=C(()=>{const a=[],p=o.value.website_schema||{"@context":"https://schema.org","@type":"WebSite",name:o.value.site_name||"МНКА",description:o.value.site_description||"Профессиональные услуги по подбору и оформлению земельных участков",url:window.location.origin};a.push(p);const g=o.value.organization_schema||{"@context":"https://schema.org","@type":"Organization",name:o.value.site_name||"МНКА",url:window.location.origin};return a.push(g),a}),S=async()=>{try{const a=await fetch("/api/public/seo-settings");if(a.ok){const p=await a.json();if(p.data){const g=p.data.site_name&&p.data.site_name.trim()!==""&&p.data.site_name!=="Laravel"&&p.data.site_name.toLowerCase()!=="laravel",P=p.data.site_description&&p.data.site_description.trim()!=="",l={...c,...p.data,site_name:g?p.data.site_name:c.site_name,site_description:P?p.data.site_description:c.site_description,site_keywords:p.data.site_keywords&&p.data.site_keywords.trim()!==""?p.data.site_keywords:c.site_keywords};o.value=l}}}catch(a){console.error("Error fetching SEO settings:",a)}},j=async()=>{try{const a=await fetch("/api/public/home-page-settings");if(a.ok){const p=await a.json();p.data&&(e.value=p.data)}}catch(a){console.error("Error fetching home page settings:",a)}};V(()=>{S(),j(),m()});const y=C(()=>{const a=o.value.site_name;return!a||a.trim()===""||a==="Laravel"||a.toLowerCase()==="laravel"?c.site_name:a}),v=C(()=>{const a=o.value.site_description;return!a||a.trim()===""?c.site_description:a}),E=C(()=>{const a=o.value.site_keywords;return!a||a.trim()===""?c.site_keywords:a});return{blocks:t,loading:i,orderedBlocks:r,seoSettings:o,seoTitle:y,seoDescription:v,seoKeywords:E,canonicalUrl:_,combinedSchema:q}}},Kt={class:"home-page"};function Rt(s,t,i,e,c,o){const r=B("SEOHead");return u(),f("div",Kt,[F(r,{title:e.seoTitle,description:e.seoDescription,keywords:e.seoKeywords,"og-image":e.seoSettings.default_og_image,"og-type":e.seoSettings.og_type||"website",canonical:e.canonicalUrl,schema:e.combinedSchema},null,8,["title","description","keywords","og-image","og-type","canonical","schema"]),(u(!0),f(N,null,Q(e.orderedBlocks,(m,_)=>(u(),I(W(m.component),X({key:m.key},{ref_for:!0},m.props),null,16))),128))])}const as=z(Ut,[["render",Rt]]);export{as as default};
