import{_ as w,r as p,o as B,e as c,f as y,h as s,A as J,a as I,t as f,w as N,B as L,d,m as O,b as j,C as F,T as A,c as Q,F as z,l as S,k as E,n as K,i as $,v as D,j as R,g as Z,D as G,x as X}from"./app-4C-xA3Sw.js";const W={name:"HeroBanner",props:{slug:{type:String,default:"home-banner"}},setup(n){const t=p(null),o=p(!0),e=async()=>{try{const l=await fetch(`/api/public/banners/${n.slug}`);if(l.ok){const a=await l.json();a.data&&(t.value={...a.data,background_image:a.data.background_image?`/${a.data.background_image.replace(/^\//,"")}`:null})}}catch(l){console.error("Error fetching banner:",l)}finally{o.value=!1}},m=()=>{t.value.button_type==="method"&&console.log("Method button clicked:",t.value.button_value)};return B(()=>{e()}),{banner:t,loading:o,handleButtonClick:m}}},Y={class:"w-full px-3 sm:px-4 md:px-5 mt-3"},ee={key:0,class:"relative w-full max-w-[1200px] mx-auto rounded-lg min-h-[350px] sm:min-h-[450px] md:min-h-[550px] lg:min-h-[650px] overflow-hidden shadow-sm"},te={class:"relative z-10 w-full px-4 sm:px-6 lg:px-8 h-full min-h-[350px] sm:min-h-[450px] md:min-h-[550px] lg:min-h-[650px] flex items-center"},se={class:"w-full max-w-2xl"},ne={key:0,class:"space-y-2 sm:space-y-3 mb-6 sm:mb-8"},oe={key:0,class:"text-white text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-semibold leading-tight drop-shadow-lg"},ae={key:1,class:"text-white text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-semibold leading-tight drop-shadow-lg"},re={key:2,class:"text-white text-lg sm:text-xl md:text-2xl lg:text-3xl font-normal leading-relaxed whitespace-pre-line drop-shadow-md"};function ie(n,t,o,e,m,l){return d(),c("div",Y,[e.banner&&e.banner.is_active?(d(),c("section",ee,[s("div",{class:"absolute inset-0 bg-cover bg-center bg-no-repeat bg-[#6C7B6D]",style:J({backgroundImage:e.banner.background_image?`url('${e.banner.background_image}')`:"none",backgroundSize:"cover",backgroundPosition:"center"})},null,4),s("div",te,[s("div",se,[e.banner.heading_1||e.banner.heading_2||e.banner.description?(d(),c("div",ne,[e.banner.heading_1?(d(),c("h1",oe,f(e.banner.heading_1),1)):y("",!0),e.banner.heading_2?(d(),c("h2",ae,f(e.banner.heading_2),1)):y("",!0),e.banner.description?(d(),c("p",re,f(e.banner.description),1)):y("",!0)])):y("",!0),e.banner.button_text?(d(),I(L(e.banner.button_type==="method"?"button":"router-link"),{key:1,to:e.banner.button_type==="url"?e.banner.button_value:void 0,onClick:e.handleButtonClick,class:"inline-block bg-[#657C6C] hover:bg-[#55695a] active:bg-[#48554a] text-white font-medium text-base sm:text-lg px-8 sm:px-10 md:px-12 py-3 sm:py-3.5 md:py-4 rounded-lg transition-all duration-200 transform hover:scale-[1.02] active:scale-100 shadow-lg"},{default:N(()=>[O(f(e.banner.button_text),1)]),_:1},8,["to","onClick"])):y("",!0)])])])):y("",!0)])}const le=w(W,[["render",ie]]),de={name:"DecisionCard",props:{decision:{type:Object,required:!0},slug:{type:String,default:"products"}}},ce={class:"flex flex-col justify-between h-[82px] p-3 bg-[#F4F4F4] rounded-lg transition-all duration-200 hover:shadow-md hover:bg-gray-50"},ue={class:"name text-sm sm:text-base font-normal text-gray-900 leading-tight mb-2"};function me(n,t,o,e,m,l){const a=j("router-link");return d(),I(a,{to:`/${o.slug}${o.decision.slug}`,class:"block"},{default:N(()=>[s("div",ce,[s("div",ue,f(o.decision.name),1),t[0]||(t[0]=s("div",{class:"flex items-center justify-end gap-2"},[s("span",{class:"text-xs sm:text-sm font-normal text-[#688E67]"},"подробнее"),s("svg",{width:"16",height:"8",viewBox:"0 0 16 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M15.3536 4.35355C15.5488 4.15829 15.5488 3.84171 15.3536 3.64645L12.1716 0.464465C11.9763 0.269203 11.6597 0.269203 11.4645 0.464465C11.2692 0.659727 11.2692 0.97631 11.4645 1.17157L14.2929 4L11.4645 6.82843C11.2692 7.02369 11.2692 7.34027 11.4645 7.53553C11.6597 7.7308 11.9763 7.7308 12.1716 7.53553L15.3536 4.35355ZM0 4L4.37114e-08 4.5L15 4.5L15 4L15 3.5L-4.37114e-08 3.5L0 4Z",fill:"#688E67"})])],-1))])]),_:1},8,["to"])}const xe=w(de,[["render",me]]),fe={name:"Decisions",components:{DecisionCard:xe,Transition:A,TransitionGroup:F},setup(){const n=p("Выберите решение под ваш участок"),t=p([]),o=p(!0),e=p(null),m=async()=>{try{const h=await fetch("/api/public/decision-block/settings");if(!h.ok)throw new Error("Ошибка загрузки настроек");const C=await h.json();C.data&&C.data.title&&(n.value=C.data.title)}catch(h){console.error("Ошибка загрузки настроек:",h)}},l=async()=>{o.value=!0,e.value=null;try{const h=await fetch("/api/public/decision-block/chapters");if(!h.ok)throw new Error("Ошибка загрузки данных");const T=(await h.json()).data||[];t.value=T.map((k,V)=>({id:k.id,name:k.name,active:V===0,items:[...(k.products||[]).map(q=>({...q,category:"products"})),...(k.services||[]).map(q=>({...q,category:"services"}))]})),t.value.length>0&&!t.value.find(k=>k.active)&&(t.value[0].active=!0)}catch(h){console.error("Ошибка загрузки разделов:",h),e.value="Не удалось загрузить данные. Попробуйте обновить страницу."}finally{o.value=!1}},a=Q(()=>t.value.find(h=>h.active)||t.value[0]),x=Q(()=>a.value?.items||[]),v=h=>{t.value.forEach(C=>{C.active=C.id===h.id})};return B(async()=>{await Promise.all([m(),l()])}),{title:n,chapters:t,activeChapter:a,activeItems:x,setActiveChapter:v,loading:o,error:e}}},he={class:"w-full px-3 sm:px-4 md:px-5 mt-8 sm:mt-12"},ge={class:"w-full max-w-[1200px] mx-auto"},be={class:"flex justify-center mb-6 sm:mb-8"},pe={class:"text-2xl sm:text-3xl md:text-4xl font-semibold text-gray-900"},ve={key:0,class:"flex justify-center items-center py-12"},_e={key:1,class:"flex justify-center items-center py-12"},ye={class:"text-red-500"},we={key:0,class:"flex flex-col sm:flex-row gap-3 sm:gap-0 mb-6 sm:mb-8"},Ce=["onClick"];function ke(n,t,o,e,m,l){const a=j("DecisionCard");return d(),c("div",he,[s("div",ge,[s("div",be,[s("h2",pe,f(e.title),1)]),e.loading?(d(),c("div",ve,[...t[0]||(t[0]=[s("div",{class:"text-gray-500"},"Загрузка...",-1)])])):e.error?(d(),c("div",_e,[s("div",ye,f(e.error),1)])):(d(),c(z,{key:2},[e.chapters.length>0?(d(),c("div",we,[(d(!0),c(z,null,E(e.chapters,(x,v)=>(d(),c("button",{key:x.id,onClick:h=>e.setActiveChapter(x),class:K(["flex-1 px-4 sm:px-6 py-2.5 sm:py-3 text-sm sm:text-base font-normal text-center transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-offset-2","rounded-lg sm:rounded-none",x.active?"bg-[#657C6C] text-white border border-[#657C6C] hover:bg-[#55695a] focus:ring-[#657C6C] shadow-md":"bg-white text-black border border-[#657C6C] hover:bg-[#D7D7D7] focus:ring-[#657C6C] shadow-sm",v===0?x.active?"sm:rounded-l-lg sm:rounded-r-none":"sm:rounded-l-lg sm:rounded-r-none sm:border-r-0":"",v===e.chapters.length-1?x.active?"sm:rounded-r-lg sm:rounded-l-none":"sm:rounded-r-lg sm:rounded-l-none sm:border-l-0":""])},f(x.name),11,Ce))),128))])):y("",!0),S(A,{name:"fade-slide",mode:"out-in"},{default:N(()=>[e.activeItems.length>0?(d(),c("div",{key:`content-${e.activeChapter?.id}`,class:"relative"},[S(F,{name:"stagger",tag:"div",class:"grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6"},{default:N(()=>[(d(!0),c(z,null,E(e.activeItems,(x,v)=>(d(),I(a,{key:`${x.id}-${x.category}-${e.activeChapter?.id}`,decision:x,slug:x.category==="products"?"products":"services"},null,8,["decision","slug"]))),128))]),_:1})])):(d(),c("div",{key:`empty-${e.activeChapter?.id}`,class:"flex justify-center items-center py-12"},[...t[1]||(t[1]=[s("div",{class:"text-gray-500"},"В этом разделе пока нет элементов",-1)])]))]),_:1})],64))])])}const qe=w(fe,[["render",ke],["__scopeId","data-v-9be57a33"]]),$e={name:"ImagesCollect",props:{data:{type:Object,required:!0},numberQuestion:{type:Number,required:!0}},emits:["next","answer"],methods:{handleSelect(n){const t={id:n.id||n.name,name:n.name||"",title:n.title||n.name||"",text:n.title||n.name||"",src:n.src||n.webp||""};this.$emit("answer",t),n.child?setTimeout(()=>{this.$emit("next",n.child)},300):setTimeout(()=>{this.$emit("next")},300)},handleImageError(n){n.target.src="/upload/quiz/placeholder.jpg"}}},je={class:"mt-6"},ze={class:"flex items-center gap-3 sm:gap-4 mb-6 px-2"},Se={class:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-[#657C6C] text-white font-semibold text-lg sm:text-xl flex-shrink-0"},Ie={class:"question text-lg sm:text-xl md:text-2xl font-medium text-gray-900"},Ne={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4"},De=["onClick"],Qe={class:"relative aspect-[245/140] sm:aspect-[245/140] rounded-2xl overflow-hidden shadow-md hover:shadow-lg transition-all duration-300 transform hover:scale-105"},Ee=["src","alt"],Te={class:"absolute top-3 left-3 right-3 z-10"},Ve={class:"text-white font-medium text-base sm:text-lg md:text-xl drop-shadow-lg"};function Be(n,t,o,e,m,l){return d(),c("div",je,[s("div",ze,[s("div",Se,f(o.data.id),1),s("div",Ie,f(o.data.question),1)]),s("div",Ne,[(d(!0),c(z,null,E(o.data.selects,a=>(d(),c("div",{key:a.id,class:"relative group cursor-pointer",onClick:x=>l.handleSelect(a)},[s("div",Qe,[s("img",{src:a.src||a.webp||"/upload/quiz/placeholder.jpg",alt:a.name||a.title,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",onError:t[0]||(t[0]=(...x)=>l.handleImageError&&l.handleImageError(...x))},null,40,Ee),t[1]||(t[1]=s("div",{class:"absolute inset-0 bg-gradient-to-b from-black/60 via-black/20 to-transparent pointer-events-none"},null,-1)),s("div",Te,[s("h3",Ve,f(a.title),1)])])],8,De))),128))])])}const Ae=w($e,[["render",Be]]),Me={name:"Selects",props:{data:{type:Object,required:!0},numberQuestion:{type:Number,required:!0}},emits:["next","answer"],methods:{handleSelect(n){const t={id:n.id||n.name,name:n.name||"",title:n.title||n.name||"",text:n.name||n.title||""};this.$emit("answer",t),setTimeout(()=>{this.$emit("next")},300)}}},Le={class:"mt-6"},Oe={class:"flex items-center gap-3 sm:gap-4 mb-6 px-2"},Fe={class:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-[#657C6C] text-white font-semibold text-lg sm:text-xl flex-shrink-0"},He={class:"question text-lg sm:text-xl md:text-2xl font-medium text-gray-900"},Pe={class:"space-y-3 sm:space-y-4 max-w-2xl"},Ue=["onClick"];function Je(n,t,o,e,m,l){return d(),c("div",Le,[s("div",Oe,[s("div",Fe,f(o.data.id),1),s("div",He,f(o.data.question),1)]),s("div",Pe,[(d(!0),c(z,null,E(o.data.selects,a=>(d(),c("button",{key:a.id,onClick:x=>l.handleSelect(a),class:"w-full px-6 py-4 text-left bg-white border-2 border-gray-200 rounded-lg hover:border-[#657C6C] hover:bg-gray-50 transition-all duration-200 text-base sm:text-lg font-normal text-gray-900 focus:outline-none focus:ring-2 focus:ring-[#657C6C] focus:ring-offset-2"},f(a.name),9,Ue))),128))])])}const Ke=w(Me,[["render",Je]]),Re={name:"Inputs",props:{data:{type:Object,required:!0},numberQuestion:{type:Number,required:!0}},emits:["next","answer"],setup(n,{emit:t}){const o=p(n.data?.answer||""),e=Q(()=>{const l=o.value;return l==null?!1:l.toString().trim()!==""});return{answerValue:o,isAnswerValid:e,handleNext:()=>{const l=o.value?.toString().trim()||"";l&&(n.data&&(n.data.answer=l),t("answer",l),n.data?.child?t("next",n.data.child):t("next"))}}}},Ze={class:"mt-6"},Ge={class:"flex items-center gap-3 sm:gap-4 mb-6 px-2"},Xe={class:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-[#657C6C] text-white font-semibold text-lg sm:text-xl flex-shrink-0"},We={class:"question text-lg sm:text-xl md:text-2xl font-medium text-gray-900"},Ye={class:"max-w-2xl"},et={class:"block text-sm font-medium text-gray-700 mb-2"},tt={class:"flex flex-col sm:flex-row gap-3 sm:gap-4"},st=["placeholder"],nt=["disabled"];function ot(n,t,o,e,m,l){return d(),c("div",Ze,[s("div",Ge,[s("div",Xe,f(o.data.id),1),s("div",We,f(o.data.question),1)]),s("div",Ye,[s("label",et,f(o.data.label),1),s("div",tt,[$(s("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>e.answerValue=a),type:"text",placeholder:o.data.placeholder,onKeyup:t[1]||(t[1]=R((...a)=>e.handleNext&&e.handleNext(...a),["enter"])),class:"flex-1 w-full rounded-md border border-gray-300 bg-white px-4 py-3 text-sm sm:text-base transition-colors disabled:opacity-50 focus:border-[#657C6C] focus:ring-2 focus:ring-[#657C6C]/20 focus:outline-none"},null,40,st),[[D,e.answerValue]]),s("button",{onClick:t[2]||(t[2]=(...a)=>e.handleNext&&e.handleNext(...a)),disabled:!e.isAnswerValid,class:"px-6 sm:px-8 py-3 bg-[#657C6C] hover:bg-[#55695a] disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[#657C6C] focus:ring-offset-2"}," Далее ",8,nt)])])])}const at=w(Re,[["render",ot]]),rt={name:"Forms",props:{data:{type:Object,required:!0},numberQuestion:{type:Number,required:!0}},emits:["next","answer"],computed:{isFormValid(){return this.data.form.name&&this.data.form.name.trim()!==""&&this.data.form.email&&this.data.form.email.trim()!==""&&this.data.form.phone&&this.data.form.phone.trim()!==""&&this.data.form.check}},methods:{async handleSubmit(){this.isFormValid&&(this.$emit("answer",this.data.form),this.$emit("submit",{name:this.data.form.name,email:this.data.form.email,phone:this.data.form.phone}))}}},it={class:"mt-6"},lt={class:"mb-6 px-2"},dt=["innerHTML"],ct={class:"max-w-2xl"},ut={class:"flex items-start"},mt=["disabled"];function xt(n,t,o,e,m,l){return d(),c("div",it,[s("div",lt,[s("div",{class:"question text-lg sm:text-xl md:text-2xl font-medium text-gray-900",innerHTML:o.data.question},null,8,dt)]),s("div",ct,[s("form",{onSubmit:t[4]||(t[4]=Z((...a)=>l.handleSubmit&&l.handleSubmit(...a),["prevent"])),class:"space-y-4"},[s("div",null,[t[5]||(t[5]=s("label",{for:"quiz-name",class:"block text-sm font-medium text-gray-700 mb-2"}," Ваше имя ",-1)),$(s("input",{id:"quiz-name","onUpdate:modelValue":t[0]||(t[0]=a=>o.data.form.name=a),type:"text",required:"",class:"w-full rounded-md border border-gray-300 bg-white px-4 py-3 text-sm sm:text-base transition-colors focus:border-[#657C6C] focus:ring-2 focus:ring-[#657C6C]/20 focus:outline-none",placeholder:"Иван Иванов"},null,512),[[D,o.data.form.name]])]),s("div",null,[t[6]||(t[6]=s("label",{for:"quiz-email",class:"block text-sm font-medium text-gray-700 mb-2"}," Ваш email ",-1)),$(s("input",{id:"quiz-email","onUpdate:modelValue":t[1]||(t[1]=a=>o.data.form.email=a),type:"email",required:"",class:"w-full rounded-md border border-gray-300 bg-white px-4 py-3 text-sm sm:text-base transition-colors focus:border-[#657C6C] focus:ring-2 focus:ring-[#657C6C]/20 focus:outline-none",placeholder:"your@email.com"},null,512),[[D,o.data.form.email]])]),s("div",null,[t[7]||(t[7]=s("label",{for:"quiz-phone",class:"block text-sm font-medium text-gray-700 mb-2"}," Ваш телефон ",-1)),$(s("input",{id:"quiz-phone","onUpdate:modelValue":t[2]||(t[2]=a=>o.data.form.phone=a),type:"tel",required:"",class:"w-full rounded-md border border-gray-300 bg-white px-4 py-3 text-sm sm:text-base transition-colors focus:border-[#657C6C] focus:ring-2 focus:ring-[#657C6C]/20 focus:outline-none",placeholder:"+7 (999) 123-45-67"},null,512),[[D,o.data.form.phone]])]),s("div",ut,[$(s("input",{id:"quiz-check","onUpdate:modelValue":t[3]||(t[3]=a=>o.data.form.check=a),type:"checkbox",required:"",class:"mt-1 h-4 w-4 rounded border-gray-300 text-[#657C6C] focus:ring-[#657C6C] focus:ring-2"},null,512),[[G,o.data.form.check]]),t[8]||(t[8]=s("label",{for:"quiz-check",class:"ml-3 text-sm text-gray-600"}," Отправляя данную форму, вы соглашаетесь на обработку персональных данных ",-1))]),s("button",{type:"submit",disabled:!l.isFormValid,class:"w-full sm:w-auto px-8 py-3 bg-[#657C6C] hover:bg-[#55695a] disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[#657C6C] focus:ring-offset-2"}," Отправить ",8,mt)],32)])])}const ft=w(rt,[["render",xt]]),ht={name:"Thank",props:{data:{type:Object,default:()=>({})},numberQuestion:{type:Number,required:!0}}},gt={class:"mt-6"};function bt(n,t,o,e,m,l){return d(),c("div",gt,[...t[0]||(t[0]=[X('<div class="flex flex-col items-center justify-center py-8 sm:py-12 px-4"><div class="w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-green-100 flex items-center justify-center mb-6"><svg class="w-8 h-8 sm:w-10 sm:h-10 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div><h3 class="text-xl sm:text-2xl md:text-3xl font-semibold text-gray-900 text-center mb-4"> Спасибо! </h3><p class="text-base sm:text-lg text-gray-600 text-center max-w-md"> Наши специалисты свяжутся с вами в течение 15 минут </p></div>',1)])])}const pt=w(ht,[["render",bt]]),vt={name:"Quiz",components:{"images-collect":Ae,selects:Ke,inputs:at,forms:ft,thank:pt},props:{title:{type:String,default:"Подберите идеальное решение"},description:{type:String,default:"Ответьте на несколько вопросов, и мы предложим оптимальный вариант"}},setup(){const n=p(!0),t=p(null),o=p(null),e=p([]),m=p(1),l=p([]),a=p(!1),x=p({}),v=p(!1),h=p(!1),C=async()=>{try{const r=await fetch("/api/public/quiz-block/settings");if(!r.ok)throw new Error("Ошибка загрузки настроек");const i=await r.json();i.data?(a.value=i.data.is_active===!0,i.data.quiz_id?await T(i.data.quiz_id):n.value=!1):n.value=!1}catch(r){console.error("Ошибка загрузки настроек блока квиза:",r),n.value=!1}},T=async r=>{n.value=!0,t.value=null;try{const i=await fetch(`/api/public/quiz-block/quiz/${r}`);if(!i.ok)throw new Error("Ошибка загрузки квиза");const u=await i.json();u.data&&(o.value={id:u.data.id,title:u.data.title,description:u.data.description},e.value=(u.data.questions||[]).filter(g=>g.is_active!==!1).sort((g,b)=>(g.order||0)-(b.order||0)).map((g,b)=>({...g,displayId:b+1})),e.value.length>0&&(m.value=e.value[0].displayId,l.value=[]))}catch(i){t.value=i.message||"Ошибка загрузки квиза",console.error("Ошибка загрузки квиза:",i)}finally{n.value=!1}},k=r=>{const i={id:r.displayId||r.id||r.order,question:r.question_text||"",type:r.question_type,...r.question_data||{}};return(r.question_type==="images-collect"||r.question_type==="selects")&&r.question_data?.selects&&(i.selects=r.question_data.selects.map((u,g)=>({id:u.id||g+1,name:u.name||"",src:u.src||"",title:u.title||u.name||"",child:u.child||null}))),r.question_type==="inputs"&&r.question_data&&(i.label=r.question_data.label||"",i.placeholder=r.question_data.placeholder||"",i.child=r.question_data.child||null,i.answer=""),r.question_type==="forms"&&r.question_data&&(i.form=r.question_data.form||{name:"",email:"",phone:"",check:!1},i.child=r.question_data.child||null,i.question=r.question_text||r.question_data.question||""),i},V=Q(()=>e.value.find(r=>r.displayId===m.value)),q=r=>{const i=m.value;if(i&&!l.value.includes(i)&&l.value.push(i),r){const u=e.value.findIndex(g=>g.displayId===m.value);r>0&&r<=e.value.length?m.value=r:u<e.value.length-1&&(m.value=e.value[u+1].displayId)}else{const u=e.value.findIndex(g=>g.displayId===m.value);u<e.value.length-1&&(m.value=e.value[u+1].displayId)}},H=()=>{const r=e.value.findIndex(i=>i.displayId===m.value);if(r>0){const i=e.value[r-1];if(i){const u=l.value.lastIndexOf(m.value);u!==-1&&(l.value=l.value.slice(0,u)),m.value=i.displayId}}},P=r=>{const i=e.value.find(u=>u.displayId===m.value);i&&(x.value[i.id]={question_id:i.id,question_text:i.question_text,question_type:i.question_type,answer:r})},M=async r=>{if(!(h.value||v.value)){h.value=!0;try{const i=e.value.filter(_=>x.value[_.id]).map(_=>x.value[_.id].answer),u=await fetch("/api/public/quiz/submit",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({quiz_id:o.value.id,answers:i,contact:r})});let g="",b=null;try{if(g=await u.text(),g)try{b=JSON.parse(g)}catch(_){throw console.error("Ошибка парсинга JSON:",_,"Response text:",g.substring(0,200)),new Error("Сервер вернул некорректный ответ. Пожалуйста, попробуйте еще раз.")}}catch(_){throw console.error("Ошибка чтения ответа:",_),new Error("Ошибка получения ответа от сервера")}if(!u.ok){const _=b&&b.message||b&&b.error||`Ошибка сервера: ${u.status} ${u.statusText}`;throw new Error(_)}if(!b)throw console.error("Сервер вернул пустой ответ. Response text:",g.substring(0,200)),new Error("Сервер вернул пустой ответ");if(typeof b!="object")throw console.error("Сервер вернул некорректный тип данных:",typeof b,b),new Error("Сервер вернул некорректный ответ");if(b.success===!0)return v.value=!0,{success:!0,message:b.message||"Спасибо за прохождение квиза!"};{const _=b.message||b.error||"Ошибка отправки результатов квиза";throw new Error(_)}}catch(i){return console.error("Ошибка отправки результатов квиза:",i),{success:!1,message:i.message||"Ошибка отправки результатов квиза. Пожалуйста, попробуйте еще раз."}}finally{h.value=!1}}},U=async r=>{const i=await M(r);i.success?q():alert(i.message||"Произошла ошибка при отправке результатов. Пожалуйста, попробуйте еще раз.")};return B(()=>{C()}),{loading:n,error:t,quizData:o,questions:e,currentQuestionNumber:m,currentQuestion:V,isActive:a,isCompleted:v,isSubmitting:h,formatQuestionData:k,goToNext:q,goToPrevious:H,handleAnswer:P,handleSubmit:U,submitQuiz:M,questionHistory:l}}},_t={key:0,class:"w-full px-3 sm:px-4 md:px-5 mt-8 sm:mt-12 mb-8 sm:mb-12"},yt={class:"w-full max-w-[1200px] mx-auto"},wt={class:"flex flex-col items-center mb-6 sm:mb-8"},Ct={class:"text-2xl sm:text-3xl md:text-4xl font-semibold text-gray-900 text-center mb-3"},kt={key:0,class:"text-gray-600 text-center text-base sm:text-lg"},qt={key:0,class:"flex justify-center items-center py-12"},$t={key:1,class:"flex justify-center items-center py-12"},jt={class:"text-red-500"},zt={key:0,class:"mb-4"};function St(n,t,o,e,m,l){return e.isActive?(d(),c("div",_t,[s("div",yt,[s("div",wt,[s("h2",Ct,f(e.quizData?.title||o.title),1),e.quizData?.description||o.description?(d(),c("p",kt,f(e.quizData?.description||o.description),1)):y("",!0)]),e.loading?(d(),c("div",qt,[...t[1]||(t[1]=[s("div",{class:"text-gray-500"},"Загрузка квиза...",-1)])])):e.error?(d(),c("div",$t,[s("div",jt,f(e.error),1)])):e.currentQuestion?(d(),I(A,{key:2,name:"quiz-fade",mode:"out-in"},{default:N(()=>[s("div",null,[e.questionHistory.length>0||e.currentQuestionNumber>1?(d(),c("div",zt,[s("button",{onClick:t[0]||(t[0]=(...a)=>e.goToPrevious&&e.goToPrevious(...a)),class:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors text-sm sm:text-base"},[...t[2]||(t[2]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),O(" Назад ",-1)])])])):y("",!0),(d(),I(L(e.currentQuestion.question_type),{key:e.currentQuestion.id,data:e.formatQuestionData(e.currentQuestion),"number-question":e.currentQuestion.id,onNext:e.goToNext,onAnswer:e.handleAnswer,onSubmit:e.handleSubmit},null,40,["data","number-question","onNext","onAnswer","onSubmit"]))])]),_:1})):y("",!0)])])):y("",!0)}const It=w(vt,[["render",St],["__scopeId","data-v-0991a741"]]),Nt={name:"Home",components:{HeroBanner:le,Decisions:qe,Quiz:It}},Dt={class:"home-page"};function Qt(n,t,o,e,m,l){const a=j("HeroBanner"),x=j("Decisions"),v=j("Quiz");return d(),c("div",Dt,[S(a),S(x),S(v)])}const Tt=w(Nt,[["render",Qt]]);export{Tt as default};
