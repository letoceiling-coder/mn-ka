import{_ as k,c as i,b as t,s as P,o as n,h as b,g,t as y,F as C,l as h,d as f,e as F,f as M,r as w,m as j}from"./app-CELBx87L.js";import{C as B}from"./CaseCard-gQ9fMcpU.js";const E={name:"CaseFiltersModal",props:{cases:{type:Array,default:()=>[]}},emits:["close"]},V={class:"bg-card rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto"},T={class:"flex items-center justify-between mb-6"},$={class:"mt-6 flex gap-3"};function A(d,e,c,o,u,m){return n(),i("div",{class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e[2]||(e[2]=P(l=>d.$emit("close"),["self"]))},[t("div",V,[t("div",T,[e[4]||(e[4]=t("h3",{class:"text-xl font-semibold text-foreground"},"Фильтры",-1)),t("button",{onClick:e[0]||(e[0]=l=>d.$emit("close")),class:"text-muted-foreground hover:text-foreground transition-colors"},[...e[3]||(e[3]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])]),e[5]||(e[5]=t("div",{class:"space-y-4"},[t("p",{class:"text-muted-foreground"}," Функциональность фильтров будет реализована позже ")],-1)),t("div",$,[t("button",{onClick:e[1]||(e[1]=l=>d.$emit("close")),class:"flex-1 px-4 py-2 border border-border rounded-lg hover:bg-muted/50 transition-colors"}," Закрыть ")])])])}const z=k(E,[["render",A]]),H={name:"CasesPage",components:{CaseCard:B,CaseFiltersModal:z},setup(){const d=f(!1),e=f(null),c=f([]),o=f(!1),u=f(1),m=f(6),l=f(1),v=async()=>{d.value=!0,e.value=null;try{const s=await fetch("/api/public/cases",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok)throw new Error("Ошибка загрузки кейсов");const r=await s.json();c.value=r.data||[],c.value.length>0&&console.log("First case data:",JSON.stringify(c.value[0],null,2)),l.value=Math.ceil(c.value.length/m.value)}catch(s){console.error("Error fetching cases:",s),e.value=s.message||"Ошибка загрузки кейсов"}finally{d.value=!1}},a=F(()=>{const s=(u.value-1)*m.value,r=s+m.value;return c.value.slice(s,r)}),x=()=>{const s=[];if(l.value<=5)for(let r=1;r<=l.value;r++)s.push(r);else{for(let r=1;r<=5;r++)s.push(r);s.push(`6-${l.value}`)}return s},L=s=>{if(typeof s=="number")return s===u.value;if(typeof s=="string"&&s.includes("-")){const[r,p]=s.split("-").map(Number);return u.value>=r&&u.value<=(p||l.value)}return!1},_=s=>{let r;if(typeof s=="string"&&s.includes("-")){const[p]=s.split("-").map(Number);r=p}else if(typeof s=="number")r=s;else return;r>=1&&r<=l.value&&(u.value=r,window.scrollTo({top:0,behavior:"smooth"}))};return M(()=>{v()}),{loading:d,error:e,cases:c,displayedCases:a,showFilters:o,currentPage:u,totalPages:l,getPageNumbers:x,isPageActive:L,goToPage:_}}},S={class:"cases-page min-h-screen bg-white"},Z={class:"w-full px-3 sm:px-4 md:px-5"},D={class:"w-full max-w-[1200px] mx-auto py-8 md:py-12"},G={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8 md:mb-12"},J={key:0,class:"py-12 flex items-center justify-center"},O={key:1,class:"py-12"},q={class:"p-4 bg-red-50 border border-red-200 rounded-lg"},K={class:"text-red-600"},Q={key:2},R={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8 mb-12"},U={key:1,class:"py-12 text-center"},W={key:3,class:"flex justify-center items-center gap-2 mt-12"},X=["onClick"];function Y(d,e,c,o,u,m){const l=w("CaseCard"),v=w("CaseFiltersModal");return n(),i("div",S,[t("div",Z,[t("div",D,[t("div",G,[e[3]||(e[3]=t("h1",{class:"text-2xl md:text-3xl lg:text-4xl font-bold text-black"}," Наши кейсы ",-1)),t("button",{onClick:e[0]||(e[0]=a=>o.showFilters=!0),class:"inline-flex items-center gap-2 px-4 py-2 text-black rounded-lg hover:bg-gray-100 transition-colors font-medium text-sm sm:text-base"},[...e[2]||(e[2]=[t("svg",{width:"20",height:"20",viewBox:"0 0 28 30",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5"},[t("path",{d:"M5.12793 3.49121L12 11.8545V21.0713L12.0781 21.1445L15.5771 24.4775L16 24.8799V11.8369L22.8721 3.49219L23.208 3.08301H4.79199L5.12793 3.49121ZM9.00098 12.8252L8.94434 12.7559L0.5625 2.54102C0.321139 2.24571 0.213888 1.87335 0.260742 1.50586C0.307646 1.13894 0.504723 0.800599 0.814453 0.567383C1.11116 0.360285 1.42861 0.25 1.75195 0.25H26.248C26.5711 0.25 26.8881 0.36058 27.1846 0.567383C27.4947 0.800614 27.6923 1.13869 27.7393 1.50586C27.7861 1.87335 27.6789 2.24571 27.4375 2.54102L19.0557 12.7559L18.999 12.8252V28.1465L19.002 28.1641C19.0611 28.5862 18.9122 29.0337 18.5781 29.3242L18.7422 29.5127L18.7383 29.5088L18.5771 29.3242L18.5693 29.332C18.4312 29.4638 18.2662 29.5687 18.084 29.6406C17.9018 29.7126 17.7057 29.75 17.5078 29.75C17.3101 29.7499 17.1147 29.7125 16.9326 29.6406C16.796 29.5866 16.6688 29.5143 16.5557 29.4258L16.4473 29.332L9.43066 22.6494L9.42871 22.6475L9.31445 22.5273C9.208 22.4022 9.12497 22.2609 9.06934 22.1094C8.99514 21.9071 8.97129 21.6915 8.99902 21.4795L9.00098 21.4629V12.8252Z",fill:"currentColor"})],-1),t("span",null,"Фильтры",-1)])])]),o.loading?(n(),i("div",J,[...e[4]||(e[4]=[t("div",{class:"text-center"},[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-[#688E67] mb-4"}),t("p",{class:"text-gray-600"},"Загрузка кейсов...")],-1)])])):g("",!0),o.error&&!o.loading?(n(),i("div",O,[t("div",q,[t("p",K,y(o.error),1)])])):g("",!0),!o.loading&&!o.error?(n(),i("div",Q,[o.cases.length>0?(n(),i("div",R,[(n(!0),i(C,null,h(o.displayedCases,a=>(n(),b(l,{key:a.id,"case-item":a},null,8,["case-item"]))),128))])):(n(),i("div",U,[...e[5]||(e[5]=[t("p",{class:"text-gray-600 text-lg"},"Кейсы пока не добавлены",-1)])]))])):g("",!0),!o.loading&&!o.error&&o.totalPages>1?(n(),i("div",W,[(n(!0),i(C,null,h(o.getPageNumbers(),a=>(n(),i("button",{key:a,onClick:x=>o.goToPage(a),class:j(["px-4 py-2 rounded-lg text-sm font-medium transition-colors min-w-[40px]",o.isPageActive(a)?"bg-[#688E67] text-white":"bg-white text-black border border-gray-300 hover:bg-gray-100"])},y(a),11,X))),128))])):g("",!0)])]),o.showFilters?(n(),b(v,{key:0,cases:o.cases,onClose:e[1]||(e[1]=a=>o.showFilters=!1)},null,8,["cases"])):g("",!0)])}const ee=k(H,[["render",Y]]);export{ee as default};
