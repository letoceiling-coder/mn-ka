import{_ as j,c as n,b as e,g as i,t as d,p as b,v as V,C as L,F as C,l as y,j as H,d as l,e as S,f as T,G as h,D,o as a,m as E}from"./app-DGcwVKox.js";import{S as x}from"./sweetalert2.esm.all-C0u8rGqG.js";const N={name:"Cases",setup(){const g=D(),s=l(!0),c=l(null),o=l([]),p=l([]),u=l(""),t=l(""),f=async()=>{s.value=!0,c.value=null;try{const r=await h.get("/api/v1/cases");o.value=r.data.data||[]}catch(r){c.value=r.response?.data?.message||"Ошибка загрузки кейсов",console.error("Error fetching cases:",r)}finally{s.value=!1}},w=async()=>{try{const r=await h.get("/api/v1/chapters");p.value=r.data.data||[]}catch(r){console.error("Error fetching chapters:",r)}},k=S(()=>{let r=o.value;if(u.value){const v=u.value.toLowerCase();r=r.filter(m=>m.name.toLowerCase().includes(v))}return t.value&&(r=r.filter(v=>v.chapter_id==t.value)),r}),_=()=>{g.push({name:"admin.cases.create"})},B=r=>{g.push({name:"admin.cases.edit",params:{id:r.id}})},M=async r=>{if((await x.fire({title:"Удалить кейс?",text:"Это действие нельзя отменить",icon:"warning",showCancelButton:!0,confirmButtonText:"Да, удалить",cancelButtonText:"Отмена",confirmButtonColor:"#ef4444"})).isConfirmed)try{await h.delete(`/api/v1/cases/${r}`),await x.fire({title:"Удалено",icon:"success",timer:2e3,showConfirmButton:!1}),f()}catch(m){await x.fire({title:"Ошибка",text:m.response?.data?.message||"Не удалось удалить кейс",icon:"error"})}};return T(()=>{f(),w()}),{loading:s,error:c,cases:o,chapters:p,searchQuery:u,selectedChapter:t,filteredCases:k,openCreateModal:_,editCase:B,deleteCase:M}}},Q={class:"cases-page space-y-6"},z={key:0,class:"flex items-center justify-center py-12"},F={key:1,class:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg"},U={class:"text-destructive"},q={key:2,class:"space-y-4"},A={class:"flex items-center justify-between"},G={class:"flex items-center gap-4"},R=["value"],J={key:0,class:"text-center py-12 text-muted-foreground"},K={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},O={key:0,class:"w-full h-48 overflow-hidden bg-muted"},P=["src","alt"],W={class:"p-4"},X={class:"font-semibold text-foreground mb-2"},Y={key:0,class:"text-sm text-muted-foreground mb-2"},Z={class:"flex items-center justify-between mt-4"},$={class:"flex gap-2"},I=["onClick"],ee=["onClick"];function te(g,s,c,o,p,u){return a(),n("div",Q,[s[9]||(s[9]=e("div",null,[e("h1",{class:"text-3xl font-semibold text-foreground"},"Кейсы"),e("p",{class:"text-muted-foreground mt-1"},"Управление кейсами (портфолио проектов)")],-1)),o.loading?(a(),n("div",z,[...s[3]||(s[3]=[e("div",{class:"flex flex-col items-center gap-4"},[e("div",{class:"w-12 h-12 border-4 border-accent border-t-transparent rounded-full animate-spin"}),e("p",{class:"text-muted-foreground"},"Загрузка кейсов...")],-1)])])):i("",!0),o.error?(a(),n("div",F,[e("p",U,d(o.error),1)])):i("",!0),!o.loading&&!o.error?(a(),n("div",q,[e("div",A,[e("div",G,[b(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>o.searchQuery=t),type:"text",placeholder:"Поиск по названию...",class:"px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent"},null,512),[[V,o.searchQuery]]),b(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>o.selectedChapter=t),class:"px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent"},[s[4]||(s[4]=e("option",{value:""},"Все разделы",-1)),(a(!0),n(C,null,y(o.chapters,t=>(a(),n("option",{key:t.id,value:t.id},d(t.name),9,R))),128))],512),[[L,o.selectedChapter]])]),e("button",{onClick:s[2]||(s[2]=(...t)=>o.openCreateModal&&o.openCreateModal(...t)),class:"px-4 py-2 bg-accent text-accent-foreground rounded-lg hover:bg-accent/90 transition-colors text-sm font-medium flex items-center gap-2"},[...s[5]||(s[5]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),H(" Добавить кейс ",-1)])])]),o.filteredCases.length===0?(a(),n("div",J,[...s[6]||(s[6]=[e("p",null,"Кейсы не найдены",-1)])])):(a(),n("div",K,[(a(!0),n(C,null,y(o.filteredCases,t=>(a(),n("div",{key:t.id,class:"bg-card border border-border rounded-lg overflow-hidden hover:shadow-md transition-shadow"},[t.image?(a(),n("div",O,[e("img",{src:t.image.url,alt:t.name,class:"w-full h-full object-cover"},null,8,P)])):i("",!0),e("div",W,[e("h3",X,d(t.name),1),t.chapter?(a(),n("p",Y," Раздел: "+d(t.chapter.name),1)):i("",!0),e("div",Z,[e("span",{class:E(["px-2 py-1 text-xs rounded",t.is_active?"bg-green-500/20 text-green-600":"bg-muted text-muted-foreground"])},d(t.is_active?"Активен":"Неактивен"),3),e("div",$,[e("button",{onClick:f=>o.editCase(t),class:"p-2 text-accent hover:bg-accent/10 rounded transition-colors",title:"Редактировать"},[...s[7]||(s[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,I),e("button",{onClick:f=>o.deleteCase(t.id),class:"p-2 text-destructive hover:bg-destructive/10 rounded transition-colors",title:"Удалить"},[...s[8]||(s[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ee)])])])]))),128))]))])):i("",!0)])}const re=j(N,[["render",te]]);export{re as default};
